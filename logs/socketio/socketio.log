2025-05-31 18:41:18 [INFO]: ✅ PostgreSQL client connected 
2025-05-31 18:41:18 [INFO]: ✅ PostgreSQL connection test successful: {"now":"2025-05-31T18:41:18.322Z"}
2025-05-31 18:41:18 [INFO]: ✅ PostgreSQL connected successfully 
2025-05-31 18:41:18 [INFO]: ✅ Redis connected successfully 
2025-05-31 18:41:18 [INFO]: ✅ Socket.IO Redis adapter configured 
2025-05-31 18:41:18 [INFO]: ✅ Kafka producer connected successfully 
2025-05-31 18:41:19 [INFO]: ✅ Created Kafka topics: user-actions, post-events, story-events, comment-events, like-events, notification-events, study-group-events, chat-events, voice-call-events, file-events, presence-events 
2025-05-31 18:41:19 [INFO]: ✅ Kafka consumer connected successfully with group: socketio-server 
2025-05-31 18:41:19 [INFO]: ✅ Kafka producer and consumer initialized 
2025-05-31 18:41:27 [INFO]: 🚀 Socket.IO server running on 0.0.0.0:3001 
2025-05-31 18:41:27 [INFO]: 📡 CORS origins: http://localhost:3000,http://host.docker.internal:3000 
2025-05-31 18:41:27 [INFO]: 💾 Redis: redis:6379 
2025-05-31 18:41:27 [INFO]: 📨 Kafka: kafka:9092 
2025-05-31 18:41:27 [INFO]: 🔐 Auth: NextAuth 5 JWT validation enabled 
2025-05-31 18:41:27 [INFO]: ⚡ Max connections: 1000 
2025-05-31 18:41:48 [INFO]: 🔄 PostgreSQL client removed 
2025-05-31 18:51:13 [INFO]: 🛑 Received SIGTERM. Starting graceful shutdown... 
2025-05-31 18:51:13 [INFO]: ✅ HTTP server closed 
2025-05-31 18:51:13 [INFO]: ✅ Redis connections closed 
2025-05-31 18:51:13 [INFO]: ✅ Socket.IO server closed 
2025-05-31 18:51:14 [INFO]: ✅ Kafka connections closed 
2025-05-31 18:51:48 [INFO]: ✅ PostgreSQL client connected 
2025-05-31 18:51:48 [INFO]: ✅ PostgreSQL connection test successful: {"now":"2025-05-31T18:51:48.895Z"}
2025-05-31 18:51:48 [INFO]: ✅ PostgreSQL connected successfully 
2025-05-31 18:51:48 [INFO]: ✅ Redis connected successfully 
2025-05-31 18:51:48 [INFO]: ✅ Socket.IO Redis adapter configured 
2025-05-31 18:51:48 [INFO]: ⏳ Waiting for Kafka group coordinator to be ready... 
2025-05-31 18:51:59 [INFO]: ✅ Kafka producer connected successfully 
2025-05-31 18:51:59 [INFO]: ✅ All Kafka topics already exist 
2025-05-31 18:51:59 [INFO]: ⏳ Waiting for Kafka consumer group coordinator for group: socketio-server... 
2025-05-31 18:52:14 [INFO]: ✅ Kafka consumer connected successfully with group: socketio-server 
2025-05-31 18:52:14 [INFO]: ✅ Kafka producer and consumer initialized 
2025-05-31 18:52:14 [INFO]: 🚀 Socket.IO server running on 0.0.0.0:3001 
2025-05-31 18:52:14 [INFO]: 📡 CORS origins: http://localhost:3000,http://host.docker.internal:3000 
2025-05-31 18:52:14 [INFO]: 💾 Redis: redis:6379 
2025-05-31 18:52:14 [INFO]: 📨 Kafka: kafka:9092 
2025-05-31 18:52:14 [INFO]: 🔐 Auth: NextAuth 5 JWT validation enabled 
2025-05-31 18:52:14 [INFO]: ⚡ Max connections: 1000 
2025-05-31 18:52:18 [INFO]: 🔄 PostgreSQL client removed 
2025-05-31 23:56:39 [INFO]: 🛑 Received SIGTERM. Starting graceful shutdown... 
2025-05-31 23:56:39 [INFO]: ✅ HTTP server closed 
2025-05-31 23:56:39 [INFO]: ✅ Redis connections closed 
2025-05-31 23:56:39 [INFO]: ✅ Socket.IO server closed 
2025-05-31 23:56:47 [INFO]: ✅ Kafka connections closed 
2025-05-31 23:57:55 [INFO]: ✅ PostgreSQL client connected 
2025-05-31 23:57:55 [INFO]: ✅ PostgreSQL connection test successful: {"now":"2025-05-31T23:57:55.700Z"}
2025-05-31 23:57:55 [INFO]: ✅ PostgreSQL connected successfully 
2025-05-31 23:57:55 [INFO]: ✅ Redis connected successfully 
2025-05-31 23:57:55 [INFO]: ✅ Socket.IO Redis adapter configured 
2025-05-31 23:57:55 [INFO]: ⏳ Waiting for Kafka group coordinator to be ready... 
2025-05-31 23:58:06 [INFO]: ✅ Kafka producer connected successfully 
2025-05-31 23:58:06 [INFO]: ✅ All Kafka topics already exist 
2025-05-31 23:58:06 [INFO]: ⏳ Waiting for Kafka consumer group coordinator for group: socketio-server... 
2025-05-31 23:58:21 [INFO]: ✅ Kafka consumer connected successfully with group: socketio-server 
2025-05-31 23:58:21 [INFO]: ✅ Kafka producer and consumer initialized 
2025-05-31 23:58:21 [INFO]: 🚀 Socket.IO server running on 0.0.0.0:3001 
2025-05-31 23:58:21 [INFO]: 📡 CORS origins: http://localhost:3000,http://host.docker.internal:3000 
2025-05-31 23:58:21 [INFO]: 💾 Redis: redis:6379 
2025-05-31 23:58:21 [INFO]: 📨 Kafka: kafka:9092 
2025-05-31 23:58:21 [INFO]: 🔐 Auth: NextAuth 5 JWT validation enabled 
2025-05-31 23:58:21 [INFO]: ⚡ Max connections: 1000 
2025-05-31 23:58:25 [INFO]: 🔄 PostgreSQL client removed 
2025-06-01 02:35:54 [INFO]: ✅ PostgreSQL client connected 
2025-06-01 02:35:54 [INFO]: ✅ PostgreSQL connection test successful: {"now":"2025-06-01T02:35:54.699Z"}
2025-06-01 02:35:54 [INFO]: ✅ PostgreSQL connected successfully 
2025-06-01 02:35:54 [INFO]: ✅ Redis connected successfully 
2025-06-01 02:35:54 [INFO]: ✅ Socket.IO Redis adapter configured 
2025-06-01 02:35:54 [INFO]: ⏳ Waiting for Kafka group coordinator to be ready... 
2025-06-01 02:36:05 [INFO]: ✅ Kafka producer connected successfully 
2025-06-01 02:36:05 [INFO]: ✅ All Kafka topics already exist 
2025-06-01 02:36:05 [INFO]: ⏳ Waiting for Kafka consumer group coordinator for group: socketio-server... 
2025-06-01 02:36:20 [INFO]: ✅ Kafka consumer connected successfully with group: socketio-server 
2025-06-01 02:36:20 [INFO]: ✅ Kafka producer and consumer initialized 
2025-06-01 02:36:20 [INFO]: 🚀 Socket.IO server running on 0.0.0.0:3001 
2025-06-01 02:36:20 [INFO]: 📡 CORS origins: http://localhost:3000,http://host.docker.internal:3000 
2025-06-01 02:36:20 [INFO]: 💾 Redis: redis:6379 
2025-06-01 02:36:20 [INFO]: 📨 Kafka: kafka:9092 
2025-06-01 02:36:20 [INFO]: 🔐 Auth: NextAuth 5 JWT validation enabled 
2025-06-01 02:36:20 [INFO]: 🔑 Internal API: Enabled for testing 
2025-06-01 02:36:20 [INFO]: ⚡ Max connections: 1000 
2025-06-01 02:36:24 [INFO]: 🔄 PostgreSQL client removed 
2025-06-01 02:41:53 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-01 02:41:53 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 02:41:53 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-01 02:41:53 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-01 02:41:53 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748745713704","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"A1O03YpAGs8vJpGvAAAB","timestamp":"2025-06-01T02:41:53.705Z","source":"socketio-server"}}
2025-06-01 02:41:53 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:41:53 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-01 02:41:53 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-01 02:42:01 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: client namespace disconnect 
2025-06-01 02:42:01 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-01 02:42:01 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-01 02:42:01 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-01 02:42:01 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748745721792","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-01T02:42:01.792Z","timestamp":"2025-06-01T02:42:01.792Z","source":"socketio-server"}}
2025-06-01 02:42:01 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:44:17 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-01 02:44:17 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 02:44:17 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-01 02:44:17 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:44:17 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748745857934","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"6LmpiJHwCat2nqewAAAD","timestamp":"2025-06-01T02:44:17.934Z","source":"socketio-server"}}
2025-06-01 02:44:17 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:44:17 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:44:17 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-01 02:44:18 [ERROR]: unhandledRejection: logError is not defined
ReferenceError: logError is not defined
    at Socket.<anonymous> (/app/handlers/presence.js:55:7)
    at Socket.emit (node:events:518:28)
    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)
    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {"error":{},"stack":"ReferenceError: logError is not defined\n    at Socket.<anonymous> (/app/handlers/presence.js:55:7)\n    at Socket.emit (node:events:518:28)\n    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)\n    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","rejection":true,"date":"Sun Jun 01 2025 02:44:18 GMT+0000 (Coordinated Universal Time)","process":{"pid":7,"uid":1001,"gid":65533,"cwd":"/app","execPath":"/usr/local/bin/node","version":"v22.16.0","argv":["/usr/local/bin/node","/app/server.js"],"memoryUsage":{"rss":102514688,"heapTotal":23552000,"heapUsed":21848152,"external":2674486,"arrayBuffers":346352}},"os":{"loadavg":[3.08,3.06,2.88],"uptime":3281.34},"trace":[{"column":7,"file":"/app/handlers/presence.js","function":null,"line":55,"method":null,"native":false},{"column":28,"file":"node:events","function":"Socket.emit","line":518,"method":"emit","native":false},{"column":22,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js","function":"Socket.emitUntyped","line":69,"method":"emitUntyped","native":false},{"column":39,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js","function":null,"line":697,"method":null,"native":false},{"column":11,"file":"node:internal/process/task_queues","function":"process.processTicksAndRejections","line":85,"method":"processTicksAndRejections","native":false}]}
2025-06-01 02:44:19 [ERROR]: unhandledRejection: logError is not defined
ReferenceError: logError is not defined
    at Socket.<anonymous> (/app/handlers/presence.js:296:7)
    at Socket.emit (node:events:518:28)
    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)
    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {"error":{},"stack":"ReferenceError: logError is not defined\n    at Socket.<anonymous> (/app/handlers/presence.js:296:7)\n    at Socket.emit (node:events:518:28)\n    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)\n    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","rejection":true,"date":"Sun Jun 01 2025 02:44:19 GMT+0000 (Coordinated Universal Time)","process":{"pid":7,"uid":1001,"gid":65533,"cwd":"/app","execPath":"/usr/local/bin/node","version":"v22.16.0","argv":["/usr/local/bin/node","/app/server.js"],"memoryUsage":{"rss":103038976,"heapTotal":23814144,"heapUsed":21791664,"external":2680523,"arrayBuffers":352389}},"os":{"loadavg":[3.08,3.06,2.88],"uptime":3283.3},"trace":[{"column":7,"file":"/app/handlers/presence.js","function":null,"line":296,"method":null,"native":false},{"column":28,"file":"node:events","function":"Socket.emit","line":518,"method":"emit","native":false},{"column":22,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js","function":"Socket.emitUntyped","line":69,"method":"emitUntyped","native":false},{"column":39,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js","function":null,"line":697,"method":null,"native":false},{"column":11,"file":"node:internal/process/task_queues","function":"process.processTicksAndRejections","line":85,"method":"processTicksAndRejections","native":false}]}
2025-06-01 02:44:22 [WARN]: ❌ No authentication token provided 
2025-06-01 02:44:22 [WARN]: ❌ No authentication token provided 
2025-06-01 02:44:22 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-01 02:44:22 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:44:22 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748745862102","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-01T02:44:22.102Z","timestamp":"2025-06-01T02:44:22.102Z","source":"socketio-server"}}
2025-06-01 02:44:22 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:44:22 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:44:22 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-01 02:45:37 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-01 02:45:37 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 02:45:37 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-01 02:45:37 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:45:37 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748745937158","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"7gLlyTkxyRw6VjHQAAAJ","timestamp":"2025-06-01T02:45:37.158Z","source":"socketio-server"}}
2025-06-01 02:45:37 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:45:37 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:45:37 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-01 02:45:37 [ERROR]: unhandledRejection: logError is not defined
ReferenceError: logError is not defined
    at Socket.<anonymous> (/app/handlers/presence.js:55:7)
    at Socket.emit (node:events:518:28)
    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)
    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {"error":{},"stack":"ReferenceError: logError is not defined\n    at Socket.<anonymous> (/app/handlers/presence.js:55:7)\n    at Socket.emit (node:events:518:28)\n    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)\n    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","rejection":true,"date":"Sun Jun 01 2025 02:45:37 GMT+0000 (Coordinated Universal Time)","process":{"pid":7,"uid":1001,"gid":65533,"cwd":"/app","execPath":"/usr/local/bin/node","version":"v22.16.0","argv":["/usr/local/bin/node","/app/server.js"],"memoryUsage":{"rss":103370752,"heapTotal":24338432,"heapUsed":22729152,"external":2776358,"arrayBuffers":448224}},"os":{"loadavg":[2.87,2.98,2.86],"uptime":3360.55},"trace":[{"column":7,"file":"/app/handlers/presence.js","function":null,"line":55,"method":null,"native":false},{"column":28,"file":"node:events","function":"Socket.emit","line":518,"method":"emit","native":false},{"column":22,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js","function":"Socket.emitUntyped","line":69,"method":"emitUntyped","native":false},{"column":39,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js","function":null,"line":697,"method":null,"native":false},{"column":11,"file":"node:internal/process/task_queues","function":"process.processTicksAndRejections","line":85,"method":"processTicksAndRejections","native":false}]}
2025-06-01 02:45:39 [ERROR]: unhandledRejection: logError is not defined
ReferenceError: logError is not defined
    at Socket.<anonymous> (/app/handlers/presence.js:296:7)
    at Socket.emit (node:events:518:28)
    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)
    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {"error":{},"stack":"ReferenceError: logError is not defined\n    at Socket.<anonymous> (/app/handlers/presence.js:296:7)\n    at Socket.emit (node:events:518:28)\n    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)\n    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","rejection":true,"date":"Sun Jun 01 2025 02:45:39 GMT+0000 (Coordinated Universal Time)","process":{"pid":7,"uid":1001,"gid":65533,"cwd":"/app","execPath":"/usr/local/bin/node","version":"v22.16.0","argv":["/usr/local/bin/node","/app/server.js"],"memoryUsage":{"rss":103313408,"heapTotal":24338432,"heapUsed":23195920,"external":2745507,"arrayBuffers":417373}},"os":{"loadavg":[2.8,2.96,2.86],"uptime":3362.5},"trace":[{"column":7,"file":"/app/handlers/presence.js","function":null,"line":296,"method":null,"native":false},{"column":28,"file":"node:events","function":"Socket.emit","line":518,"method":"emit","native":false},{"column":22,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js","function":"Socket.emitUntyped","line":69,"method":"emitUntyped","native":false},{"column":39,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js","function":null,"line":697,"method":null,"native":false},{"column":11,"file":"node:internal/process/task_queues","function":"process.processTicksAndRejections","line":85,"method":"processTicksAndRejections","native":false}]}
2025-06-01 02:45:41 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-01 02:45:41 [WARN]: ❌ Missing origin/referer header 
2025-06-01 02:45:41 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-01 02:45:41 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:45:41 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748745941278","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-01T02:45:41.278Z","timestamp":"2025-06-01T02:45:41.278Z","source":"socketio-server"}}
2025-06-01 02:45:41 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:45:41 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:45:41 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-01 02:46:08 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-01 02:46:08 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 02:46:08 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-01 02:46:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:46:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:46:08 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-01 02:46:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748745968051","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"8p4rCjqTPhzQlLkIAAAN","timestamp":"2025-06-01T02:46:08.051Z","source":"socketio-server"}}
2025-06-01 02:46:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:46:08 [ERROR]: unhandledRejection: logError is not defined
ReferenceError: logError is not defined
    at Socket.<anonymous> (/app/handlers/presence.js:55:7)
    at Socket.emit (node:events:518:28)
    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)
    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {"error":{},"stack":"ReferenceError: logError is not defined\n    at Socket.<anonymous> (/app/handlers/presence.js:55:7)\n    at Socket.emit (node:events:518:28)\n    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)\n    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","rejection":true,"date":"Sun Jun 01 2025 02:46:08 GMT+0000 (Coordinated Universal Time)","process":{"pid":7,"uid":1001,"gid":65533,"cwd":"/app","execPath":"/usr/local/bin/node","version":"v22.16.0","argv":["/usr/local/bin/node","/app/server.js"],"memoryUsage":{"rss":103661568,"heapTotal":24862720,"heapUsed":23295144,"external":2796835,"arrayBuffers":468701}},"os":{"loadavg":[2.94,2.98,2.87],"uptime":3391.45},"trace":[{"column":7,"file":"/app/handlers/presence.js","function":null,"line":55,"method":null,"native":false},{"column":28,"file":"node:events","function":"Socket.emit","line":518,"method":"emit","native":false},{"column":22,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js","function":"Socket.emitUntyped","line":69,"method":"emitUntyped","native":false},{"column":39,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js","function":null,"line":697,"method":null,"native":false},{"column":11,"file":"node:internal/process/task_queues","function":"process.processTicksAndRejections","line":85,"method":"processTicksAndRejections","native":false}]}
2025-06-01 02:46:10 [ERROR]: unhandledRejection: logError is not defined
ReferenceError: logError is not defined
    at Socket.<anonymous> (/app/handlers/presence.js:296:7)
    at Socket.emit (node:events:518:28)
    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)
    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {"error":{},"stack":"ReferenceError: logError is not defined\n    at Socket.<anonymous> (/app/handlers/presence.js:296:7)\n    at Socket.emit (node:events:518:28)\n    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)\n    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","rejection":true,"date":"Sun Jun 01 2025 02:46:10 GMT+0000 (Coordinated Universal Time)","process":{"pid":7,"uid":1001,"gid":65533,"cwd":"/app","execPath":"/usr/local/bin/node","version":"v22.16.0","argv":["/usr/local/bin/node","/app/server.js"],"memoryUsage":{"rss":103661568,"heapTotal":24862720,"heapUsed":23086840,"external":2793103,"arrayBuffers":464969}},"os":{"loadavg":[2.94,2.98,2.87],"uptime":3393.44},"trace":[{"column":7,"file":"/app/handlers/presence.js","function":null,"line":296,"method":null,"native":false},{"column":28,"file":"node:events","function":"Socket.emit","line":518,"method":"emit","native":false},{"column":22,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js","function":"Socket.emitUntyped","line":69,"method":"emitUntyped","native":false},{"column":39,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js","function":null,"line":697,"method":null,"native":false},{"column":11,"file":"node:internal/process/task_queues","function":"process.processTicksAndRejections","line":85,"method":"processTicksAndRejections","native":false}]}
2025-06-01 02:46:12 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-01 02:46:12 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 02:46:12 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-01 02:46:12 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:46:12 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748745972167","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"lDufJsFYNZBEUSaIAAAP","timestamp":"2025-06-01T02:46:12.167Z","source":"socketio-server"}}
2025-06-01 02:46:12 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:46:12 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:46:12 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:15 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:16 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:17 [WARN]: ❌ No authentication token provided 
2025-06-01 02:46:32 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-01 02:46:32 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-01 02:46:32 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:46:32 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748745992683","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-01T02:46:32.683Z","timestamp":"2025-06-01T02:46:32.683Z","source":"socketio-server"}}
2025-06-01 02:46:32 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:46:32 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:46:32 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:46:32 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-01 02:46:32 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748745992683","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-01T02:46:32.683Z","timestamp":"2025-06-01T02:46:32.683Z","source":"socketio-server"}}
2025-06-01 02:46:32 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:46:32 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:46:32 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-01 02:48:00 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-01 02:48:00 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 02:48:00 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-01 02:48:00 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:00 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:00 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-01 02:48:00 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746080873","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"X0uJ2_Fi0EUMv_bxAAB3","timestamp":"2025-06-01T02:48:00.873Z","source":"socketio-server"}}
2025-06-01 02:48:00 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:01 [ERROR]: unhandledRejection: logError is not defined
ReferenceError: logError is not defined
    at Socket.<anonymous> (/app/handlers/presence.js:55:7)
    at Socket.emit (node:events:518:28)
    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)
    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {"error":{},"stack":"ReferenceError: logError is not defined\n    at Socket.<anonymous> (/app/handlers/presence.js:55:7)\n    at Socket.emit (node:events:518:28)\n    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)\n    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","rejection":true,"date":"Sun Jun 01 2025 02:48:01 GMT+0000 (Coordinated Universal Time)","process":{"pid":7,"uid":1001,"gid":65533,"cwd":"/app","execPath":"/usr/local/bin/node","version":"v22.16.0","argv":["/usr/local/bin/node","/app/server.js"],"memoryUsage":{"rss":105500672,"heapTotal":26173440,"heapUsed":21526512,"external":2509863,"arrayBuffers":181729}},"os":{"loadavg":[3.07,2.97,2.87],"uptime":3504.44},"trace":[{"column":7,"file":"/app/handlers/presence.js","function":null,"line":55,"method":null,"native":false},{"column":28,"file":"node:events","function":"Socket.emit","line":518,"method":"emit","native":false},{"column":22,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js","function":"Socket.emitUntyped","line":69,"method":"emitUntyped","native":false},{"column":39,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js","function":null,"line":697,"method":null,"native":false},{"column":11,"file":"node:internal/process/task_queues","function":"process.processTicksAndRejections","line":85,"method":"processTicksAndRejections","native":false}]}
2025-06-01 02:48:03 [ERROR]: unhandledRejection: logError is not defined
ReferenceError: logError is not defined
    at Socket.<anonymous> (/app/handlers/presence.js:296:7)
    at Socket.emit (node:events:518:28)
    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)
    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {"error":{},"stack":"ReferenceError: logError is not defined\n    at Socket.<anonymous> (/app/handlers/presence.js:296:7)\n    at Socket.emit (node:events:518:28)\n    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)\n    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","rejection":true,"date":"Sun Jun 01 2025 02:48:03 GMT+0000 (Coordinated Universal Time)","process":{"pid":7,"uid":1001,"gid":65533,"cwd":"/app","execPath":"/usr/local/bin/node","version":"v22.16.0","argv":["/usr/local/bin/node","/app/server.js"],"memoryUsage":{"rss":105500672,"heapTotal":26173440,"heapUsed":21875240,"external":2517999,"arrayBuffers":189865}},"os":{"loadavg":[2.98,2.95,2.87],"uptime":3506.35},"trace":[{"column":7,"file":"/app/handlers/presence.js","function":null,"line":296,"method":null,"native":false},{"column":28,"file":"node:events","function":"Socket.emit","line":518,"method":"emit","native":false},{"column":22,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js","function":"Socket.emitUntyped","line":69,"method":"emitUntyped","native":false},{"column":39,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js","function":null,"line":697,"method":null,"native":false},{"column":11,"file":"node:internal/process/task_queues","function":"process.processTicksAndRejections","line":85,"method":"processTicksAndRejections","native":false}]}
2025-06-01 02:48:05 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-01 02:48:05 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 02:48:05 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-01 02:48:05 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:05 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746085104","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"spDXE2q5QWjXZSp8AAB5","timestamp":"2025-06-01T02:48:05.104Z","source":"socketio-server"}}
2025-06-01 02:48:05 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:05 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:05 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 02:48:08 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 02:48:08 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:08 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746088214","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"nOke8p3FozRMq4uMAAB_","timestamp":"2025-06-01T02:48:08.214Z","source":"socketio-server"}}
2025-06-01 02:48:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:08 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 02:48:08 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:08 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746088258","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"0uN-oyy4GO3SKQnMAACA","timestamp":"2025-06-01T02:48:08.258Z","source":"socketio-server"}}
2025-06-01 02:48:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:08 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 02:48:08 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:08 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746088310","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"DV_EjENmtR-drkK4AACB","timestamp":"2025-06-01T02:48:08.310Z","source":"socketio-server"}}
2025-06-01 02:48:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:08 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 02:48:08 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746088399","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"rBanaQwueax-LW0DAACC","timestamp":"2025-06-01T02:48:08.399Z","source":"socketio-server"}}
2025-06-01 02:48:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:08 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:08 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:08 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-01 02:48:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746088455","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"mBK0k3SS-oLj9BejAACD","timestamp":"2025-06-01T02:48:08.455Z","source":"socketio-server"}}
2025-06-01 02:48:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:08 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746088624","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-01T02:48:08.624Z","timestamp":"2025-06-01T02:48:08.624Z","source":"socketio-server"}}
2025-06-01 02:48:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:08 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:08 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:08 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746088636","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-01T02:48:08.636Z","timestamp":"2025-06-01T02:48:08.636Z","source":"socketio-server"}}
2025-06-01 02:48:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:08 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:08 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 02:48:08 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:08 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746088697","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-01T02:48:08.697Z","timestamp":"2025-06-01T02:48:08.697Z","source":"socketio-server"}}
2025-06-01 02:48:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746088721","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-01T02:48:08.721Z","timestamp":"2025-06-01T02:48:08.721Z","source":"socketio-server"}}
2025-06-01 02:48:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:08 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746088746","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-01T02:48:08.746Z","timestamp":"2025-06-01T02:48:08.746Z","source":"socketio-server"}}
2025-06-01 02:48:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:08 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:08 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-01 02:48:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746088792","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"wQkw0IW15zQDfcNcAACF","timestamp":"2025-06-01T02:48:08.792Z","source":"socketio-server"}}
2025-06-01 02:48:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:10 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-01 02:48:10 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:10 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746090844","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-01T02:48:10.844Z","timestamp":"2025-06-01T02:48:10.844Z","source":"socketio-server"}}
2025-06-01 02:48:10 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:10 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:10 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-01 02:48:11 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-01 02:48:11 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 02:48:11 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-01 02:48:11 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:11 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746091906","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"4r3PTaly2HL87pPwAACH","timestamp":"2025-06-01T02:48:11.906Z","source":"socketio-server"}}
2025-06-01 02:48:11 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:11 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:11 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-01 02:48:11 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-01 02:48:11 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-01 02:48:11 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:11 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746091980","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-01T02:48:11.980Z","timestamp":"2025-06-01T02:48:11.980Z","source":"socketio-server"}}
2025-06-01 02:48:11 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:48:12 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:48:12 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:12 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-01 02:48:12 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:48:12 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-01 02:48:12 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746091982","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-01T02:48:11.982Z","timestamp":"2025-06-01T02:48:11.982Z","source":"socketio-server"}}
2025-06-01 02:48:12 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:49:36 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: ping timeout 
2025-06-01 02:49:36 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-01 02:49:36 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1748746176873","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"ping timeout","lastSeen":"2025-06-01T02:49:36.873Z","timestamp":"2025-06-01T02:49:36.873Z","source":"socketio-server"}}
2025-06-01 02:49:36 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 02:49:36 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-01 02:49:36 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-01 15:48:47 [INFO]: ✅ PostgreSQL client connected 
2025-06-01 15:48:48 [INFO]: ✅ PostgreSQL connection test successful: {"now":"2025-06-01T15:48:47.444Z"}
2025-06-01 15:48:48 [INFO]: ✅ PostgreSQL connected successfully 
2025-06-01 15:48:48 [INFO]: ✅ Redis connected successfully 
2025-06-01 15:48:48 [INFO]: ✅ Socket.IO Redis adapter configured 
2025-06-01 15:48:48 [INFO]: ⏳ Waiting for Kafka group coordinator to be ready... 
2025-06-01 15:49:17 [INFO]: 🔄 PostgreSQL client removed 
2025-06-01 15:50:11 [INFO]: ✅ Kafka producer connected successfully 
2025-06-01 15:50:11 [INFO]: ✅ All Kafka topics already exist 
2025-06-01 15:50:11 [INFO]: ⏳ Waiting for Kafka consumer group coordinator for group: socketio-server... 
2025-06-01 15:50:27 [INFO]: ✅ Kafka consumer connected successfully with group: socketio-server 
2025-06-01 15:50:27 [INFO]: ✅ Kafka producer and consumer initialized 
2025-06-01 15:50:29 [INFO]: 🚀 Socket.IO server running on 0.0.0.0:3001 
2025-06-01 15:50:29 [INFO]: 📡 CORS origins: http://localhost:3000,http://host.docker.internal:3000 
2025-06-01 15:50:29 [INFO]: 💾 Redis: redis:6379 
2025-06-01 15:50:29 [INFO]: 📨 Kafka: kafka:9092 
2025-06-01 15:50:29 [INFO]: 🔐 Auth: NextAuth 5 JWT validation enabled 
2025-06-01 15:50:29 [INFO]: 🔑 Internal API: Enabled for testing 
2025-06-01 15:50:29 [INFO]: ⚡ Max connections: 1000 
2025-06-01 16:06:53 [WARN]: ❌ No authentication token provided 
2025-06-01 16:12:57 [WARN]: ❌ No authentication token provided 
2025-06-01 16:13:59 [WARN]: ❌ No authentication token provided 
2025-06-01 16:39:38 [WARN]: ❌ No authentication token provided 
2025-06-01 16:40:18 [WARN]: ❌ No authentication token provided 
2025-06-01 16:43:08 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-01 16:43:08 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 16:43:08 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-01 16:43:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-01 16:43:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-01 16:43:08 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-01 16:43:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748796188219","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"_s8rabynZNXFMRlEAAAQ","timestamp":"2025-06-01T16:43:08.219Z","source":"socketio-server"}}
2025-06-01 16:43:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 16:43:41 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-01 16:43:41 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-01 16:43:41 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748796221206","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-01T16:43:41.205Z","timestamp":"2025-06-01T16:43:41.206Z","source":"socketio-server"}}
2025-06-01 16:43:41 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 16:43:41 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-01 16:43:41 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-01 16:43:59 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-01 16:43:59 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 16:43:59 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-01 16:43:59 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-01 16:43:59 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-01 16:43:59 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-01 16:43:59 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748796239026","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"wU12tE9nRiU3-2SjAAAT","timestamp":"2025-06-01T16:43:59.026Z","source":"socketio-server"}}
2025-06-01 16:43:59 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 16:49:54 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: client namespace disconnect 
2025-06-01 16:49:54 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-01 16:49:54 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748796594199","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-01T16:49:54.199Z","timestamp":"2025-06-01T16:49:54.199Z","source":"socketio-server"}}
2025-06-01 16:49:54 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 16:49:54 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-01 16:49:54 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-01 16:51:03 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-01 16:51:03 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 16:51:03 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-01 16:51:03 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-01 16:51:03 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-01 16:51:03 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-01 16:51:04 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748796663943","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"g5UderxRRT9Cts_FAAAW","timestamp":"2025-06-01T16:51:03.943Z","source":"socketio-server"}}
2025-06-01 16:51:04 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 16:52:16 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-01 16:52:16 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-01 16:52:16 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748796736870","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-01T16:52:16.869Z","timestamp":"2025-06-01T16:52:16.870Z","source":"socketio-server"}}
2025-06-01 16:52:16 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 16:52:16 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-01 16:52:16 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-01 16:52:37 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-01 16:52:37 [WARN]: ❌ Missing origin/referer header 
2025-06-01 17:14:33 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-01 17:14:33 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-01 17:14:33 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-01 17:14:38 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-01 17:14:38 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748798073478","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"njDOywlLFcWXlPXVAAAb","timestamp":"2025-06-01T17:14:33.478Z","source":"socketio-server"}}
2025-06-01 17:14:38 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 17:14:38 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-01 17:14:38 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-01 17:41:41 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-01 17:41:41 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-01 17:41:41 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748799701678","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-01T17:41:41.678Z","timestamp":"2025-06-01T17:41:41.678Z","source":"socketio-server"}}
2025-06-01 17:41:41 [WARN]: Unknown Kafka topic: user-actions 
2025-06-01 17:41:41 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-01 17:41:41 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 00:34:46 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 00:34:46 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 00:34:46 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 00:34:46 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 00:34:46 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 00:34:46 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 00:34:46 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748824486493","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"V3Z3_KpFrLsWyEvUAAAd","timestamp":"2025-06-02T00:34:46.493Z","source":"socketio-server"}}
2025-06-02 00:34:46 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 00:35:27 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 00:35:27 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 00:35:27 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748824527069","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T00:35:27.069Z","timestamp":"2025-06-02T00:35:27.070Z","source":"socketio-server"}}
2025-06-02 00:35:27 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 00:35:27 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 00:35:27 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 00:35:32 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 00:35:32 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 00:35:32 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 00:35:32 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 00:35:32 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 00:35:32 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 00:35:32 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748824532434","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"KfziIkCb5cDcS1yAAAAg","timestamp":"2025-06-02T00:35:32.434Z","source":"socketio-server"}}
2025-06-02 00:35:32 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 03:03:33 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 03:03:33 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 03:03:33 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 03:03:33 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 03:03:33 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748833413554","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T03:03:33.554Z","timestamp":"2025-06-02T03:03:33.554Z","source":"socketio-server"}}
2025-06-02 03:03:33 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 03:23:58 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 03:23:58 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 03:23:58 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 03:23:58 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 03:23:58 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748834638578","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"_prtWJg_UKw0IhhGAAAi","timestamp":"2025-06-02T03:23:58.578Z","source":"socketio-server"}}
2025-06-02 03:23:58 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 03:23:58 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 03:23:58 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 06:00:13 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 06:00:13 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 06:00:13 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748844013226","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T06:00:13.226Z","timestamp":"2025-06-02T06:00:13.226Z","source":"socketio-server"}}
2025-06-02 06:00:13 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 06:00:14 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 06:00:14 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 06:21:17 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 06:21:17 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 06:21:17 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 06:21:17 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 06:21:17 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 06:21:17 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 06:21:18 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748845277943","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"bAQUI6NgbwcUZDGKAAAk","timestamp":"2025-06-02T06:21:17.943Z","source":"socketio-server"}}
2025-06-02 06:21:18 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 06:36:33 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 06:36:33 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 06:36:33 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748846193390","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T06:36:33.390Z","timestamp":"2025-06-02T06:36:33.390Z","source":"socketio-server"}}
2025-06-02 06:36:33 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 06:36:33 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 06:36:33 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 06:37:40 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 06:37:40 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 06:37:40 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 06:37:40 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 06:37:40 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 06:37:40 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 06:37:40 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748846260304","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"tSBamHcZMYZjXaEpAAAn","timestamp":"2025-06-02T06:37:40.304Z","source":"socketio-server"}}
2025-06-02 06:37:40 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 08:20:20 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 08:20:20 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 08:20:20 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748852420030","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T08:20:20.030Z","timestamp":"2025-06-02T08:20:20.030Z","source":"socketio-server"}}
2025-06-02 08:20:20 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 08:20:20 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 08:20:20 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 09:36:28 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 09:36:28 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 09:36:28 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 09:36:28 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 09:36:28 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 09:36:28 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 09:36:28 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748856988710","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"co4TuIFLC4J6spQhAAAp","timestamp":"2025-06-02T09:36:28.710Z","source":"socketio-server"}}
2025-06-02 09:36:28 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 09:42:41 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 09:42:41 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 09:42:41 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748857361288","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T09:42:41.288Z","timestamp":"2025-06-02T09:42:41.288Z","source":"socketio-server"}}
2025-06-02 09:42:41 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 09:42:41 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 09:42:41 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 09:43:37 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 09:43:37 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 09:43:37 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 09:43:37 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 09:43:37 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 09:43:37 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 09:43:37 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748857417252","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"oqIBkaqannS3IpHZAAAs","timestamp":"2025-06-02T09:43:37.252Z","source":"socketio-server"}}
2025-06-02 09:43:37 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 09:47:11 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 09:47:11 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 09:47:11 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748857631372","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T09:47:11.372Z","timestamp":"2025-06-02T09:47:11.372Z","source":"socketio-server"}}
2025-06-02 09:47:11 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 09:47:11 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 09:47:11 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 09:47:16 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 09:47:16 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 09:47:16 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 09:47:16 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 09:47:17 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 09:47:17 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 09:47:17 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748857636974","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"7wwF4cLIIe-U-6BbAAAv","timestamp":"2025-06-02T09:47:16.974Z","source":"socketio-server"}}
2025-06-02 09:47:17 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 09:56:41 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 09:56:41 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 09:56:41 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748858201751","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T09:56:41.751Z","timestamp":"2025-06-02T09:56:41.751Z","source":"socketio-server"}}
2025-06-02 09:56:41 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 09:56:41 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 09:56:41 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 09:56:43 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 09:56:43 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 09:56:43 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 09:56:43 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 09:56:43 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 09:56:43 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 09:56:43 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748858203543","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"dcgBaeMn__rz9NQnAAAy","timestamp":"2025-06-02T09:56:43.543Z","source":"socketio-server"}}
2025-06-02 09:56:43 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:01:07 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 10:01:07 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 10:01:07 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748858467469","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T10:01:07.469Z","timestamp":"2025-06-02T10:01:07.469Z","source":"socketio-server"}}
2025-06-02 10:01:07 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:01:07 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 10:01:07 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 10:01:08 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 10:01:08 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 10:01:08 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 10:01:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 10:01:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 10:01:08 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 10:01:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748858468879","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"Wvr_bg7BebNqgb3fAAA1","timestamp":"2025-06-02T10:01:08.879Z","source":"socketio-server"}}
2025-06-02 10:01:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:09:00 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 10:09:01 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 10:09:01 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748858941045","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T10:09:01.045Z","timestamp":"2025-06-02T10:09:01.045Z","source":"socketio-server"}}
2025-06-02 10:09:01 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:09:01 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 10:09:01 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 10:09:02 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 10:09:02 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 10:09:02 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 10:09:02 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 10:09:02 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748858942764","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"QVhjjYxXHxnJ5GBUAAA4","timestamp":"2025-06-02T10:09:02.764Z","source":"socketio-server"}}
2025-06-02 10:09:02 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:09:02 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 10:09:02 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 10:14:15 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 10:14:15 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 10:14:15 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748859255825","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T10:14:15.825Z","timestamp":"2025-06-02T10:14:15.825Z","source":"socketio-server"}}
2025-06-02 10:14:15 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:14:15 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 10:14:15 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 10:14:17 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 10:14:17 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 10:14:17 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 10:14:17 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 10:14:17 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748859257645","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"R5rgFccsmIq20ICBAAA7","timestamp":"2025-06-02T10:14:17.645Z","source":"socketio-server"}}
2025-06-02 10:14:17 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:14:17 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 10:14:17 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 10:15:29 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 10:15:29 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 10:15:29 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748859329510","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T10:15:29.510Z","timestamp":"2025-06-02T10:15:29.510Z","source":"socketio-server"}}
2025-06-02 10:15:29 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:15:29 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 10:15:29 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 10:15:31 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 10:15:31 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 10:15:31 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 10:15:31 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 10:15:31 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 10:15:31 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 10:15:31 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748859331874","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"hvfqZxo4GR3vjujkAAA-","timestamp":"2025-06-02T10:15:31.874Z","source":"socketio-server"}}
2025-06-02 10:15:31 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:25:02 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 10:25:02 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 10:25:02 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748859902404","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T10:25:02.404Z","timestamp":"2025-06-02T10:25:02.404Z","source":"socketio-server"}}
2025-06-02 10:25:02 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:25:02 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 10:25:02 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 10:25:03 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 10:25:03 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 10:25:03 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 10:25:03 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 10:25:03 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748859903833","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"NwwEeEuzGlB5N_ZCAABB","timestamp":"2025-06-02T10:25:03.833Z","source":"socketio-server"}}
2025-06-02 10:25:03 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:25:03 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 10:25:03 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 10:34:48 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 10:34:48 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 10:34:48 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748860488821","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T10:34:48.821Z","timestamp":"2025-06-02T10:34:48.821Z","source":"socketio-server"}}
2025-06-02 10:34:48 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:34:48 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 10:34:48 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 10:34:50 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 10:34:50 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 10:34:50 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 10:34:50 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 10:34:50 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 10:34:50 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 10:34:50 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748860490819","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"KQNP_JwOrNQyfAmmAABE","timestamp":"2025-06-02T10:34:50.819Z","source":"socketio-server"}}
2025-06-02 10:34:50 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:39:02 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 10:39:02 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 10:39:02 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748860742982","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T10:39:02.982Z","timestamp":"2025-06-02T10:39:02.982Z","source":"socketio-server"}}
2025-06-02 10:39:02 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:39:03 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 10:39:03 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 10:39:44 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 10:39:44 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 10:39:44 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 10:39:44 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 10:39:44 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748860784230","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"Ep_rW0oZyMDEmFybAABH","timestamp":"2025-06-02T10:39:44.230Z","source":"socketio-server"}}
2025-06-02 10:39:44 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:39:44 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 10:39:44 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 10:40:36 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 10:40:36 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 10:40:36 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748860836126","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T10:40:36.126Z","timestamp":"2025-06-02T10:40:36.126Z","source":"socketio-server"}}
2025-06-02 10:40:36 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 10:40:36 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 10:40:36 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 11:05:49 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 11:05:49 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 11:05:49 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 11:05:49 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 11:05:49 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748862349310","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"ieqPgUinWhb19dQdAABJ","timestamp":"2025-06-02T11:05:49.310Z","source":"socketio-server"}}
2025-06-02 11:05:49 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 11:05:49 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 11:05:49 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 11:21:54 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 11:21:54 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 11:21:54 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748863314259","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T11:21:54.259Z","timestamp":"2025-06-02T11:21:54.260Z","source":"socketio-server"}}
2025-06-02 11:21:54 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 11:21:54 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 11:21:54 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 12:19:37 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 12:19:37 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 12:19:37 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 12:19:37 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 12:19:37 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748866777540","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"fokUxZKn4JeX7XSSAABM","timestamp":"2025-06-02T12:19:37.540Z","source":"socketio-server"}}
2025-06-02 12:19:37 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 12:19:37 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 12:19:37 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 12:23:17 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 12:23:18 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 12:23:18 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748866998080","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T12:23:18.080Z","timestamp":"2025-06-02T12:23:18.080Z","source":"socketio-server"}}
2025-06-02 12:23:18 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 12:23:18 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 12:23:18 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 12:23:54 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 12:23:54 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 12:23:54 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 12:23:54 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 12:23:54 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 12:23:54 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 12:23:54 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748867034176","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"RZUsKtqIMWuPLfB0AABP","timestamp":"2025-06-02T12:23:54.189Z","source":"socketio-server"}}
2025-06-02 12:23:54 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 13:10:27 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 13:10:27 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 13:10:27 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748869827390","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T13:10:27.390Z","timestamp":"2025-06-02T13:10:27.390Z","source":"socketio-server"}}
2025-06-02 13:10:27 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 13:10:27 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 13:10:27 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 14:02:27 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 14:02:27 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 14:02:27 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 14:02:27 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 14:02:27 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 14:02:27 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 14:02:27 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748872947412","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"KfEoGsZX5_eyMwroAABR","timestamp":"2025-06-02T14:02:27.412Z","source":"socketio-server"}}
2025-06-02 14:02:27 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 15:30:35 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 15:30:35 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 15:30:35 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748878235239","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T15:30:35.239Z","timestamp":"2025-06-02T15:30:35.239Z","source":"socketio-server"}}
2025-06-02 15:30:35 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 15:30:35 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 15:30:35 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 15:57:47 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 15:57:47 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 15:57:47 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 15:57:47 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 15:57:47 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748879867341","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"vEnxGVY-pGIutFAbAABT","timestamp":"2025-06-02T15:57:47.342Z","source":"socketio-server"}}
2025-06-02 15:57:47 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 15:57:47 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 15:57:47 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 16:10:22 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 16:10:22 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:10:22 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748880622527","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T16:10:22.527Z","timestamp":"2025-06-02T16:10:22.527Z","source":"socketio-server"}}
2025-06-02 16:10:22 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:10:22 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:10:22 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 16:10:30 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 16:10:30 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 16:10:30 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 16:10:31 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:10:31 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:10:31 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 16:10:31 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748880631014","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"OjRHNt3hARl2EWGyAABW","timestamp":"2025-06-02T16:10:31.014Z","source":"socketio-server"}}
2025-06-02 16:10:31 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:15:43 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 16:15:43 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:15:43 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748880943724","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T16:15:43.724Z","timestamp":"2025-06-02T16:15:43.724Z","source":"socketio-server"}}
2025-06-02 16:15:43 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:15:43 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:15:43 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 16:15:44 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 16:15:44 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 16:15:44 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 16:15:45 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:15:45 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748880945015","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"mDiDzAg_tM5uVleJAABZ","timestamp":"2025-06-02T16:15:45.015Z","source":"socketio-server"}}
2025-06-02 16:15:45 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:15:45 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:15:45 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 16:23:49 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 16:23:49 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:23:49 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748881429716","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T16:23:49.716Z","timestamp":"2025-06-02T16:23:49.716Z","source":"socketio-server"}}
2025-06-02 16:23:49 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:23:49 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:23:49 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 16:23:51 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 16:23:51 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 16:23:51 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 16:23:51 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:23:51 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:23:51 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 16:23:51 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748881431319","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"UR-UhbQBIVqSqgMqAABc","timestamp":"2025-06-02T16:23:51.320Z","source":"socketio-server"}}
2025-06-02 16:23:51 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:32:24 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 16:32:24 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:32:24 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748881944260","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T16:32:24.259Z","timestamp":"2025-06-02T16:32:24.260Z","source":"socketio-server"}}
2025-06-02 16:32:24 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:32:24 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:32:24 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 16:46:38 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 16:46:38 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 16:46:38 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 16:46:39 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748882798959","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"gIhSfWuKprrEGQOMAABf","timestamp":"2025-06-02T16:46:38.959Z","source":"socketio-server"}}
2025-06-02 16:46:39 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:46:39 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:46:39 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:46:39 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 16:48:45 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 16:48:45 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:48:45 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:48:45 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 16:48:45 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748882925944","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T16:48:45.944Z","timestamp":"2025-06-02T16:48:45.944Z","source":"socketio-server"}}
2025-06-02 16:48:45 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:51:24 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 16:51:24 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 16:51:24 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 16:51:24 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:51:24 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:51:24 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 16:51:24 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748883084572","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"Mr3ESjeayBdCg8BsAABi","timestamp":"2025-06-02T16:51:24.572Z","source":"socketio-server"}}
2025-06-02 16:51:24 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:51:37 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 16:51:37 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:51:37 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748883097901","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T16:51:37.901Z","timestamp":"2025-06-02T16:51:37.901Z","source":"socketio-server"}}
2025-06-02 16:51:37 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:51:37 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:51:37 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 16:51:47 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 16:51:47 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 16:51:47 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 16:51:47 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:51:47 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:51:47 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 16:51:50 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748883107933","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"DnG5RBLVVBcxQhJPAABl","timestamp":"2025-06-02T16:51:47.933Z","source":"socketio-server"}}
2025-06-02 16:51:50 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:52:17 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 16:52:17 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:52:17 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:52:17 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 16:52:17 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748883137900","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T16:52:17.900Z","timestamp":"2025-06-02T16:52:17.900Z","source":"socketio-server"}}
2025-06-02 16:52:17 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:52:22 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 16:52:22 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 16:52:22 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 16:52:22 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:52:22 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748883142173","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"VZ3omTucsy4vry3mAABo","timestamp":"2025-06-02T16:52:22.173Z","source":"socketio-server"}}
2025-06-02 16:52:22 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:52:22 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:52:22 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 16:52:32 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 16:52:32 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:52:32 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:52:32 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 16:52:32 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748883152133","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T16:52:32.133Z","timestamp":"2025-06-02T16:52:32.133Z","source":"socketio-server"}}
2025-06-02 16:52:32 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:52:33 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 16:52:33 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 16:52:33 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 16:52:33 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:52:33 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748883153271","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"VR4iQRMx2qwVadjVAABr","timestamp":"2025-06-02T16:52:33.271Z","source":"socketio-server"}}
2025-06-02 16:52:33 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:52:33 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:52:33 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 16:55:34 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 16:55:34 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:55:34 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:55:34 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 16:55:34 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748883334738","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T16:55:34.738Z","timestamp":"2025-06-02T16:55:34.738Z","source":"socketio-server"}}
2025-06-02 16:55:34 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:55:36 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 16:55:36 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 16:55:36 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 16:55:36 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:55:36 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748883336810","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"SCFFs4CCRS_8GE2YAABu","timestamp":"2025-06-02T16:55:36.810Z","source":"socketio-server"}}
2025-06-02 16:55:36 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:55:36 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:55:36 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 16:57:07 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 16:57:07 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748883427424","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T16:57:07.424Z","timestamp":"2025-06-02T16:57:07.424Z","source":"socketio-server"}}
2025-06-02 16:57:07 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 16:57:07 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 16:57:07 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 16:57:07 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 17:00:56 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 17:00:56 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 17:00:56 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 17:00:57 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 17:00:57 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748883657013","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"5pLFBp11qvtbgJ0DAABx","timestamp":"2025-06-02T17:00:57.013Z","source":"socketio-server"}}
2025-06-02 17:00:57 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 17:00:57 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 17:00:57 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 17:12:58 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 17:12:58 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 17:12:58 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748884378787","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T17:12:58.787Z","timestamp":"2025-06-02T17:12:58.787Z","source":"socketio-server"}}
2025-06-02 17:12:58 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 17:12:58 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 17:12:58 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 17:13:00 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 17:13:00 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 17:13:00 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 17:13:00 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 17:13:00 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 17:13:00 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 17:13:00 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748884380632","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"uilyLDasCS9mqPFdAAB0","timestamp":"2025-06-02T17:13:00.632Z","source":"socketio-server"}}
2025-06-02 17:13:00 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 17:21:13 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 17:21:14 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 17:21:14 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748884873987","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T17:21:13.987Z","timestamp":"2025-06-02T17:21:13.987Z","source":"socketio-server"}}
2025-06-02 17:21:14 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 17:21:14 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 17:21:14 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 17:21:17 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 17:21:17 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 17:21:17 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 17:21:17 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 17:21:17 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 17:21:17 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 17:21:17 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748884877063","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"308kq_sT76e4oHEiAAB3","timestamp":"2025-06-02T17:21:17.063Z","source":"socketio-server"}}
2025-06-02 17:21:17 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 17:23:12 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 17:23:12 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 17:23:12 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 17:23:12 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 17:23:12 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748884992872","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T17:23:12.872Z","timestamp":"2025-06-02T17:23:12.872Z","source":"socketio-server"}}
2025-06-02 17:23:12 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 17:23:33 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 17:23:33 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 17:23:33 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 17:23:33 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 17:23:33 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748885013379","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"k1jnN1mGEbILnVHLAAB6","timestamp":"2025-06-02T17:23:33.379Z","source":"socketio-server"}}
2025-06-02 17:23:33 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 17:23:33 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 17:23:33 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 17:24:00 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 17:24:00 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 17:24:00 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 17:24:00 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 17:24:00 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748885040903","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T17:24:00.903Z","timestamp":"2025-06-02T17:24:00.903Z","source":"socketio-server"}}
2025-06-02 17:24:00 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 17:24:11 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 17:24:11 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 17:24:11 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 17:24:11 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 17:24:12 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748885051990","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"4nzCXMN3abGLIgxZAAB9","timestamp":"2025-06-02T17:24:11.990Z","source":"socketio-server"}}
2025-06-02 17:24:12 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 17:24:12 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 17:24:12 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 17:24:50 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 17:24:50 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 17:24:50 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 17:24:50 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 17:24:50 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748885090268","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T17:24:50.268Z","timestamp":"2025-06-02T17:24:50.268Z","source":"socketio-server"}}
2025-06-02 17:24:50 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 17:25:48 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 17:25:48 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 17:25:48 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 17:25:48 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 17:25:48 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748885148617","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"5uE9OHLSpt7eKM1ZAACA","timestamp":"2025-06-02T17:25:48.617Z","source":"socketio-server"}}
2025-06-02 17:25:48 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 17:25:48 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 17:25:48 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 18:36:28 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-02 18:36:28 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 18:36:28 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748889388476","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-02T18:36:28.476Z","timestamp":"2025-06-02T18:36:28.477Z","source":"socketio-server"}}
2025-06-02 18:36:28 [WARN]: Unknown Kafka topic: user-actions 
2025-06-02 18:36:28 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 18:36:28 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-02 23:27:48 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-02 23:27:48 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-02 23:27:48 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-02 23:28:15 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-02 23:28:15 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-02 23:28:15 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-02 23:28:19 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748906868864","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"e3ucCym49WX4NagUAACC","timestamp":"2025-06-02T23:27:48.864Z","source":"socketio-server"}}
2025-06-02 23:28:19 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 00:30:38 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 00:30:38 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 00:30:38 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748910638220","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T00:30:38.220Z","timestamp":"2025-06-03T00:30:38.220Z","source":"socketio-server"}}
2025-06-03 00:30:38 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 00:30:38 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 00:30:38 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 00:31:56 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 00:31:56 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 00:31:56 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 00:31:56 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 00:31:56 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 00:31:56 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 00:31:56 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748910716484","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"Yo93oJva9ily2sNqAACF","timestamp":"2025-06-03T00:31:56.484Z","source":"socketio-server"}}
2025-06-03 00:31:56 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 00:52:59 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: client namespace disconnect 
2025-06-03 00:52:59 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 00:52:59 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748911979280","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-03T00:52:59.280Z","timestamp":"2025-06-03T00:52:59.280Z","source":"socketio-server"}}
2025-06-03 00:52:59 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 00:52:59 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 00:52:59 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 00:59:39 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 00:59:39 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 00:59:39 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 00:59:40 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 00:59:40 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748912379992","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"bqL5_3jnXCj5661iAACI","timestamp":"2025-06-03T00:59:39.992Z","source":"socketio-server"}}
2025-06-03 00:59:40 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 00:59:40 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 00:59:40 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 01:02:03 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 01:02:03 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 01:02:03 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748912523358","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T01:02:03.358Z","timestamp":"2025-06-03T01:02:03.358Z","source":"socketio-server"}}
2025-06-03 01:02:03 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 01:02:03 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 01:02:03 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 01:02:04 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 01:02:04 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 01:02:04 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 01:02:04 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 01:02:04 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748912524408","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"CJnxppndavvv-QbSAACL","timestamp":"2025-06-03T01:02:04.408Z","source":"socketio-server"}}
2025-06-03 01:02:04 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 01:02:04 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 01:02:04 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 01:07:50 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: client namespace disconnect 
2025-06-03 01:07:50 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 01:07:50 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 01:07:50 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 01:07:50 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748912870248","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-03T01:07:50.248Z","timestamp":"2025-06-03T01:07:50.248Z","source":"socketio-server"}}
2025-06-03 01:07:50 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 01:08:29 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 01:08:29 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 01:08:29 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 01:08:29 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 01:08:29 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 01:08:29 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 01:08:29 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748912909220","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"NasFU1RpNdU-QewAAACQ","timestamp":"2025-06-03T01:08:29.220Z","source":"socketio-server"}}
2025-06-03 01:08:29 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 01:11:56 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 01:11:56 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 01:11:56 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 01:11:56 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 01:11:56 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748913116832","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T01:11:56.832Z","timestamp":"2025-06-03T01:11:56.832Z","source":"socketio-server"}}
2025-06-03 01:11:56 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 01:11:59 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 01:11:59 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 01:11:59 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 01:11:59 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 01:11:59 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748913119528","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"3HJrUVyg_KOY__3JAACT","timestamp":"2025-06-03T01:11:59.528Z","source":"socketio-server"}}
2025-06-03 01:11:59 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 01:11:59 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 01:11:59 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 01:17:37 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 01:17:37 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 01:17:37 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 01:17:37 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 01:17:37 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748913457318","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T01:17:37.318Z","timestamp":"2025-06-03T01:17:37.318Z","source":"socketio-server"}}
2025-06-03 01:17:37 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 01:17:38 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 01:17:38 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 01:17:38 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 01:17:38 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 01:17:38 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748913458773","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"ET6NFXyATycx2HdSAACW","timestamp":"2025-06-03T01:17:38.773Z","source":"socketio-server"}}
2025-06-03 01:17:38 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 01:17:38 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 01:17:38 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 01:38:07 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 01:38:07 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 01:38:07 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748914687846","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T01:38:07.846Z","timestamp":"2025-06-03T01:38:07.846Z","source":"socketio-server"}}
2025-06-03 01:38:07 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 01:38:07 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 01:38:07 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 01:38:09 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 01:38:09 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 01:38:09 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 01:38:09 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 01:38:09 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748914689903","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"8x-V8VVcy2XAYyx-AACZ","timestamp":"2025-06-03T01:38:09.903Z","source":"socketio-server"}}
2025-06-03 01:38:09 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 01:38:09 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 01:38:09 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 01:39:25 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 01:39:25 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 01:39:25 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 01:39:25 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 01:39:25 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748914765644","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T01:39:25.644Z","timestamp":"2025-06-03T01:39:25.644Z","source":"socketio-server"}}
2025-06-03 01:39:25 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 01:41:13 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 01:41:13 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 01:41:13 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 01:41:13 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 01:41:13 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 01:41:13 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 01:41:13 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748914873341","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"IVEteuggVVM8Gq7BAACc","timestamp":"2025-06-03T01:41:13.341Z","source":"socketio-server"}}
2025-06-03 01:41:13 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 01:55:04 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 01:55:04 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 01:55:04 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748915704827","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T01:55:04.827Z","timestamp":"2025-06-03T01:55:04.827Z","source":"socketio-server"}}
2025-06-03 01:55:04 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 01:55:04 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 01:55:04 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 01:55:05 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 01:55:05 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 01:55:05 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 01:55:05 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 01:55:05 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748915705888","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"d3koJU8jL52mU54NAACf","timestamp":"2025-06-03T01:55:05.888Z","source":"socketio-server"}}
2025-06-03 01:55:05 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 01:55:05 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 01:55:05 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 02:02:57 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 02:02:57 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 02:02:57 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748916177559","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T02:02:57.559Z","timestamp":"2025-06-03T02:02:57.559Z","source":"socketio-server"}}
2025-06-03 02:02:57 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 02:02:57 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 02:02:57 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 02:03:06 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 02:03:06 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 02:03:06 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 02:03:06 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 02:03:06 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 02:03:06 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 02:03:06 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748916186426","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"5qGsbuaZbuOGdvElAACi","timestamp":"2025-06-03T02:03:06.426Z","source":"socketio-server"}}
2025-06-03 02:03:06 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 02:32:45 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 02:32:45 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 02:32:45 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 02:32:45 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 02:32:45 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748917965499","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T02:32:45.499Z","timestamp":"2025-06-03T02:32:45.499Z","source":"socketio-server"}}
2025-06-03 02:32:45 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 02:32:47 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 02:32:47 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 02:32:47 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 02:32:47 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 02:32:47 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748917967331","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"DP6XRXmvMvzzM2b5AACl","timestamp":"2025-06-03T02:32:47.331Z","source":"socketio-server"}}
2025-06-03 02:32:47 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 02:32:47 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 02:32:47 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 02:49:18 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 02:49:19 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 02:49:19 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748918958982","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T02:49:18.982Z","timestamp":"2025-06-03T02:49:18.982Z","source":"socketio-server"}}
2025-06-03 02:49:19 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 02:49:19 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 02:49:19 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 07:24:18 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 07:24:18 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 07:24:18 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 07:24:21 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 07:24:21 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 07:24:21 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 07:24:24 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748935458327","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"FqotfWtK4YvrS4XjAACn","timestamp":"2025-06-03T07:24:18.327Z","source":"socketio-server"}}
2025-06-03 07:24:24 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 07:52:11 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 07:52:11 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 07:52:11 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748937131101","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T07:52:11.101Z","timestamp":"2025-06-03T07:52:11.101Z","source":"socketio-server"}}
2025-06-03 07:52:11 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 07:52:11 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 07:52:11 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 07:52:12 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 07:52:12 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 07:52:12 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 07:52:13 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 07:52:13 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748937133001","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"oi114I5d2c6kYPzwAACq","timestamp":"2025-06-03T07:52:13.001Z","source":"socketio-server"}}
2025-06-03 07:52:13 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 07:52:13 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 07:52:13 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 08:42:24 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 08:42:24 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 08:42:24 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748940144532","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T08:42:24.532Z","timestamp":"2025-06-03T08:42:24.532Z","source":"socketio-server"}}
2025-06-03 08:42:24 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 08:42:24 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 08:42:24 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 13:05:08 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 13:05:08 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 13:05:08 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 13:05:09 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 13:05:09 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 13:05:09 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 13:05:34 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748955909178","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"4bs-WNnHPC8cMx7iAACt","timestamp":"2025-06-03T13:05:09.178Z","source":"socketio-server"}}
2025-06-03 13:05:34 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 13:07:52 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 13:07:53 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 13:07:53 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 13:07:53 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 13:07:53 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748956073865","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T13:07:53.865Z","timestamp":"2025-06-03T13:07:53.865Z","source":"socketio-server"}}
2025-06-03 13:07:53 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 13:08:21 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 13:08:21 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 13:08:21 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 13:08:21 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 13:08:21 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 13:08:21 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 13:08:21 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748956101805","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"vT9xVzDxfXqHjHXhAACw","timestamp":"2025-06-03T13:08:21.805Z","source":"socketio-server"}}
2025-06-03 13:08:21 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 13:12:55 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 13:12:56 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 13:12:56 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748956376032","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T13:12:56.032Z","timestamp":"2025-06-03T13:12:56.032Z","source":"socketio-server"}}
2025-06-03 13:12:56 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 13:12:56 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 13:12:56 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 13:13:22 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 13:13:22 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 13:13:22 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 13:13:22 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 13:13:22 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748956402891","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"g_o1YK3L2_Ke2z4jAACz","timestamp":"2025-06-03T13:13:22.891Z","source":"socketio-server"}}
2025-06-03 13:13:22 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 13:13:22 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 13:13:22 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 13:15:11 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 13:15:11 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 13:15:11 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 13:15:11 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 13:15:11 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748956511903","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T13:15:11.903Z","timestamp":"2025-06-03T13:15:11.903Z","source":"socketio-server"}}
2025-06-03 13:15:11 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 16:15:10 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 16:15:10 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 16:15:10 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 16:15:10 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 16:15:10 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748967310049","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"xdcBRy0JxP8jAdxJAAC1","timestamp":"2025-06-03T16:15:10.049Z","source":"socketio-server"}}
2025-06-03 16:15:10 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 16:15:10 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 16:15:10 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 17:55:27 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 17:55:27 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 17:55:28 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 17:55:28 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 17:55:28 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748973327292","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T17:55:27.292Z","timestamp":"2025-06-03T17:55:27.292Z","source":"socketio-server"}}
2025-06-03 17:55:28 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 23:34:58 [WARN]: Kafka consumer failed, will restart: 
2025-06-03 23:34:59 [WARN]: Kafka consumer failed, will restart: 
2025-06-03 23:35:03 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 23:35:03 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 23:35:03 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 23:35:03 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 23:35:03 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 23:35:03 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 23:36:01 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748993703362","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"KHmyZ_au9c7yr8ToAAC3","timestamp":"2025-06-03T23:35:03.362Z","source":"socketio-server"}}
2025-06-03 23:36:01 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 23:37:45 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 23:37:45 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 23:37:45 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748993865519","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T23:37:45.518Z","timestamp":"2025-06-03T23:37:45.519Z","source":"socketio-server"}}
2025-06-03 23:37:45 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 23:37:45 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 23:37:45 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 23:40:42 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 23:40:42 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 23:40:42 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 23:40:42 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 23:40:42 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 23:40:42 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-03 23:40:42 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748994042676","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"pgFGsW57VYBCW10BAAC6","timestamp":"2025-06-03T23:40:42.676Z","source":"socketio-server"}}
2025-06-03 23:40:42 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 23:58:23 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-03 23:58:24 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 23:58:24 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748995104003","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-03T23:58:24.003Z","timestamp":"2025-06-03T23:58:24.003Z","source":"socketio-server"}}
2025-06-03 23:58:24 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 23:58:24 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 23:58:24 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-03 23:58:37 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-03 23:58:37 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-03 23:58:37 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-03 23:58:38 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-03 23:58:38 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748995118431","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"km6EVt3VG7rYpQ43AAC9","timestamp":"2025-06-03T23:58:38.431Z","source":"socketio-server"}}
2025-06-03 23:58:38 [WARN]: Unknown Kafka topic: user-actions 
2025-06-03 23:58:38 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-03 23:58:38 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 00:11:24 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 00:11:24 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 00:11:24 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748995884739","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T00:11:24.739Z","timestamp":"2025-06-04T00:11:24.746Z","source":"socketio-server"}}
2025-06-04 00:11:24 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 00:11:24 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 00:11:24 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 00:12:31 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 00:12:31 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 00:12:31 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 00:12:31 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 00:12:31 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748995951220","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"tqYwp_j0v7oX9N_XAADA","timestamp":"2025-06-04T00:12:31.220Z","source":"socketio-server"}}
2025-06-04 00:12:31 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 00:12:31 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 00:12:31 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 00:26:18 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: client namespace disconnect 
2025-06-04 00:26:18 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 00:26:18 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748996778694","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-04T00:26:18.694Z","timestamp":"2025-06-04T00:26:18.694Z","source":"socketio-server"}}
2025-06-04 00:26:18 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 00:26:18 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 00:26:18 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 01:09:08 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 01:09:08 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 01:09:08 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 01:09:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 01:09:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1748999348203","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"CmYpMueRmfOvOPHjAADF","timestamp":"2025-06-04T01:09:08.203Z","source":"socketio-server"}}
2025-06-04 01:09:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 01:09:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 01:09:08 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 01:26:23 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 01:26:23 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 01:26:23 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 01:26:23 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 01:26:23 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749000383659","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T01:26:23.659Z","timestamp":"2025-06-04T01:26:23.659Z","source":"socketio-server"}}
2025-06-04 01:26:23 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 01:26:25 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 01:26:25 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 01:26:25 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 01:26:25 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 01:26:25 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 01:26:25 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 01:26:25 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749000385524","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"iUDuXNvakC8amNkRAADI","timestamp":"2025-06-04T01:26:25.524Z","source":"socketio-server"}}
2025-06-04 01:26:25 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 01:37:33 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: client namespace disconnect 
2025-06-04 01:37:33 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 01:37:33 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 01:37:33 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 01:37:33 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749001053362","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-04T01:37:33.362Z","timestamp":"2025-06-04T01:37:33.362Z","source":"socketio-server"}}
2025-06-04 01:37:33 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 01:38:15 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 01:38:15 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 01:38:15 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 01:38:15 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 01:38:15 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749001095195","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"OJx0FfLeEBo3tfVIAADN","timestamp":"2025-06-04T01:38:15.196Z","source":"socketio-server"}}
2025-06-04 01:38:15 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 01:38:15 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 01:38:15 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 01:46:55 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 01:46:56 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 01:46:56 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749001616091","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T01:46:56.091Z","timestamp":"2025-06-04T01:46:56.091Z","source":"socketio-server"}}
2025-06-04 01:46:56 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 01:46:56 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 01:46:56 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 01:46:57 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 01:46:57 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 01:46:57 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 01:46:57 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 01:46:57 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749001617131","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"jeD5HAQHtyFL-1Q1AADQ","timestamp":"2025-06-04T01:46:57.131Z","source":"socketio-server"}}
2025-06-04 01:46:57 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 01:46:57 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 01:46:57 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 02:03:58 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: client namespace disconnect 
2025-06-04 02:03:58 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 02:03:58 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749002638501","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-04T02:03:58.501Z","timestamp":"2025-06-04T02:03:58.501Z","source":"socketio-server"}}
2025-06-04 02:03:58 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 02:03:58 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 02:03:58 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 02:04:42 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 02:04:42 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 02:04:42 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 02:04:42 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 02:04:42 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 02:04:42 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 02:04:42 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749002682234","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"tkC0FNnkALvfoNCfAADV","timestamp":"2025-06-04T02:04:42.234Z","source":"socketio-server"}}
2025-06-04 02:04:42 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 02:17:13 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 02:17:13 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 02:17:13 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749003433112","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T02:17:13.112Z","timestamp":"2025-06-04T02:17:13.112Z","source":"socketio-server"}}
2025-06-04 02:17:13 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 02:17:13 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 02:17:13 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 02:18:12 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 02:18:12 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 02:18:12 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 02:18:12 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 02:18:12 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 02:18:12 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 02:18:12 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749003492950","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"0cby1LCZb3dyGn_XAADY","timestamp":"2025-06-04T02:18:12.950Z","source":"socketio-server"}}
2025-06-04 02:18:12 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 02:29:23 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 02:29:23 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 02:29:23 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749004163768","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T02:29:23.768Z","timestamp":"2025-06-04T02:29:23.768Z","source":"socketio-server"}}
2025-06-04 02:29:23 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 02:29:23 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 02:29:23 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 02:31:30 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 02:31:30 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 02:31:30 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 02:31:30 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 02:31:30 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 02:31:30 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 02:31:30 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749004290772","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"1D7p3nV_Z0unDhp7AADc","timestamp":"2025-06-04T02:31:30.772Z","source":"socketio-server"}}
2025-06-04 02:31:30 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 02:55:15 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 02:55:16 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 02:55:16 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749005715970","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T02:55:15.970Z","timestamp":"2025-06-04T02:55:15.970Z","source":"socketio-server"}}
2025-06-04 02:55:16 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 02:55:16 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 02:55:16 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 02:55:17 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 02:55:17 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 02:55:17 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 02:55:17 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 02:55:17 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749005717599","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"7Anyq2d-q9nr2WDGAADf","timestamp":"2025-06-04T02:55:17.599Z","source":"socketio-server"}}
2025-06-04 02:55:17 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 02:55:17 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 02:55:17 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 03:16:31 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: client namespace disconnect 
2025-06-04 03:16:31 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 03:16:31 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749006991318","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-04T03:16:31.318Z","timestamp":"2025-06-04T03:16:31.318Z","source":"socketio-server"}}
2025-06-04 03:16:31 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 03:16:31 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 03:16:31 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 03:26:39 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 03:26:39 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 03:26:39 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 03:26:39 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 03:26:39 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 03:26:39 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 03:26:39 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749007599839","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"O2yl6zBJER5rHt99AADi","timestamp":"2025-06-04T03:26:39.839Z","source":"socketio-server"}}
2025-06-04 03:26:39 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 05:00:34 [INFO]: ✅ PostgreSQL client connected 
2025-06-04 05:00:34 [INFO]: ✅ PostgreSQL connection test successful: {"now":"2025-06-04T05:00:34.608Z"}
2025-06-04 05:00:34 [INFO]: ✅ PostgreSQL connected successfully 
2025-06-04 05:00:34 [INFO]: ✅ Redis connected successfully 
2025-06-04 05:00:34 [INFO]: ✅ Socket.IO Redis adapter configured 
2025-06-04 05:00:34 [INFO]: ⏳ Waiting for Kafka group coordinator to be ready... 
2025-06-04 05:01:04 [INFO]: 🔄 PostgreSQL client removed 
2025-06-04 05:01:09 [INFO]: ✅ Kafka producer connected successfully 
2025-06-04 05:01:09 [INFO]: ✅ All Kafka topics already exist 
2025-06-04 05:01:09 [INFO]: ⏳ Waiting for Kafka consumer group coordinator for group: socketio-server... 
2025-06-04 05:01:24 [INFO]: ✅ Kafka consumer connected successfully with group: socketio-server 
2025-06-04 05:01:24 [INFO]: ✅ Kafka producer and consumer initialized 
2025-06-04 05:02:10 [INFO]: 🚀 Socket.IO server running on 0.0.0.0:3001 
2025-06-04 05:02:10 [INFO]: 📡 CORS origins: http://localhost:3000,http://host.docker.internal:3000 
2025-06-04 05:02:10 [INFO]: 💾 Redis: redis:6379 
2025-06-04 05:02:10 [INFO]: 📨 Kafka: kafka:9092 
2025-06-04 05:02:10 [INFO]: 🔐 Auth: NextAuth 5 JWT validation enabled 
2025-06-04 05:02:10 [INFO]: 🔑 Internal API: Enabled for testing 
2025-06-04 05:02:10 [INFO]: ⚡ Max connections: 1000 
2025-06-04 05:06:17 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 05:06:17 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 05:06:17 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 05:06:17 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 05:06:17 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 05:06:17 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 05:06:17 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749013577037","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"hYlRcwtIrMXhHmo1AAAC","timestamp":"2025-06-04T05:06:17.038Z","source":"socketio-server"}}
2025-06-04 05:06:17 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 05:06:52 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: client namespace disconnect 
2025-06-04 05:06:52 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 05:06:52 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749013612516","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-04T05:06:52.516Z","timestamp":"2025-06-04T05:06:52.516Z","source":"socketio-server"}}
2025-06-04 05:06:52 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 05:06:52 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 05:06:52 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 05:21:55 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 05:21:55 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 05:21:55 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 05:21:55 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 05:21:55 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749014515084","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"VYmKBvfP3yxkNywWAAAF","timestamp":"2025-06-04T05:21:55.084Z","source":"socketio-server"}}
2025-06-04 05:21:55 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 05:21:55 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 05:21:55 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 05:46:50 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 05:46:50 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 05:46:50 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749016010903","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T05:46:50.902Z","timestamp":"2025-06-04T05:46:50.903Z","source":"socketio-server"}}
2025-06-04 05:46:50 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 05:46:50 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 05:46:50 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 06:05:53 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 06:05:53 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 06:05:54 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 06:05:54 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 06:05:54 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749017154279","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"pLJVogaq6vVa9RJqAAAH","timestamp":"2025-06-04T06:05:54.279Z","source":"socketio-server"}}
2025-06-04 06:05:54 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 06:05:55 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 06:05:55 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 06:11:06 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 06:11:06 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 06:11:06 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 06:11:06 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 06:11:06 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749017466119","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T06:11:06.118Z","timestamp":"2025-06-04T06:11:06.119Z","source":"socketio-server"}}
2025-06-04 06:11:07 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 07:54:31 [ERROR]: ❌ PostgreSQL connection test failed: 
2025-06-04 07:54:37 [INFO]: ✅ PostgreSQL client connected 
2025-06-04 07:54:37 [INFO]: ✅ PostgreSQL connection test successful: {"now":"2025-06-04T07:54:37.309Z"}
2025-06-04 07:54:37 [INFO]: ✅ PostgreSQL connected successfully 
2025-06-04 07:54:37 [INFO]: ✅ Redis connected successfully 
2025-06-04 07:54:37 [INFO]: ✅ Socket.IO Redis adapter configured 
2025-06-04 07:54:37 [INFO]: ⏳ Waiting for Kafka group coordinator to be ready... 
2025-06-04 07:55:07 [INFO]: 🔄 PostgreSQL client removed 
2025-06-04 07:55:52 [INFO]: ✅ Kafka producer connected successfully 
2025-06-04 07:55:53 [INFO]: ✅ All Kafka topics already exist 
2025-06-04 07:55:53 [INFO]: ⏳ Waiting for Kafka consumer group coordinator for group: socketio-server... 
2025-06-04 07:56:08 [INFO]: ✅ Kafka consumer connected successfully with group: socketio-server 
2025-06-04 07:56:08 [INFO]: ✅ Kafka producer and consumer initialized 
2025-06-04 07:57:05 [INFO]: 🚀 Socket.IO server running on 0.0.0.0:3001 
2025-06-04 07:57:05 [INFO]: 📡 CORS origins: http://localhost:3000,http://host.docker.internal:3000 
2025-06-04 07:57:05 [INFO]: 💾 Redis: redis:6379 
2025-06-04 07:57:05 [INFO]: 📨 Kafka: kafka:9092 
2025-06-04 07:57:05 [INFO]: 🔐 Auth: NextAuth 5 JWT validation enabled 
2025-06-04 07:57:05 [INFO]: 🔑 Internal API: Enabled for testing 
2025-06-04 07:57:05 [INFO]: ⚡ Max connections: 1000 
2025-06-04 08:09:00 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 08:09:00 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 08:09:00 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 08:09:04 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 08:09:06 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 08:09:06 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 08:09:06 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749024541690","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"4EZA7cUz9UruGmBaAAAC","timestamp":"2025-06-04T08:09:01.690Z","source":"socketio-server"}}
2025-06-04 08:09:06 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 08:16:56 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 08:16:56 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 08:16:56 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 08:16:56 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 08:16:56 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749025016738","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T08:16:56.738Z","timestamp":"2025-06-04T08:16:56.738Z","source":"socketio-server"}}
2025-06-04 08:16:56 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 08:16:58 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 08:16:58 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 08:16:58 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 08:16:58 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 08:16:58 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749025018793","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"OqIzY5tXdNZdxPHmAAAF","timestamp":"2025-06-04T08:16:58.793Z","source":"socketio-server"}}
2025-06-04 08:16:58 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 08:16:58 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 08:16:58 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 08:27:01 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 08:27:01 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 08:27:01 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749025621693","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T08:27:01.693Z","timestamp":"2025-06-04T08:27:01.693Z","source":"socketio-server"}}
2025-06-04 08:27:01 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 08:27:01 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 08:27:01 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 08:31:49 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 08:31:49 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 08:31:49 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 08:31:51 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 08:31:51 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749025911420","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"BsgqydEZkzw1M72dAAAI","timestamp":"2025-06-04T08:31:51.420Z","source":"socketio-server"}}
2025-06-04 08:31:51 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 08:31:51 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 08:31:51 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 08:47:07 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 08:47:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 08:47:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 08:47:08 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 08:47:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749026827985","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T08:47:07.985Z","timestamp":"2025-06-04T08:47:07.985Z","source":"socketio-server"}}
2025-06-04 08:47:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 08:53:00 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 08:53:00 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 08:53:00 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 08:53:00 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 08:53:00 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 08:53:00 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 08:53:00 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749027180466","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"MRfwLHORgfMxueOCAAAL","timestamp":"2025-06-04T08:53:00.466Z","source":"socketio-server"}}
2025-06-04 08:53:00 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 09:08:04 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 09:08:04 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 09:08:04 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749028084753","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T09:08:04.753Z","timestamp":"2025-06-04T09:08:04.753Z","source":"socketio-server"}}
2025-06-04 09:08:04 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 09:08:04 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 09:08:04 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 09:27:19 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 09:27:19 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 09:27:19 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 09:27:19 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 09:27:19 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 09:27:19 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 09:27:19 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749029239196","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"81hHsiWF9sQWxRY1AAAN","timestamp":"2025-06-04T09:27:19.196Z","source":"socketio-server"}}
2025-06-04 09:27:19 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 09:48:35 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 09:48:35 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 09:48:35 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 09:48:35 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 09:48:35 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749030515393","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T09:48:35.393Z","timestamp":"2025-06-04T09:48:35.393Z","source":"socketio-server"}}
2025-06-04 09:48:35 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 09:48:37 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 09:48:37 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 09:48:37 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 09:48:37 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 09:48:37 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749030517513","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"4AVwBprotaVfHBm0AAAQ","timestamp":"2025-06-04T09:48:37.513Z","source":"socketio-server"}}
2025-06-04 09:48:37 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 09:48:37 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 09:48:37 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 09:51:13 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 09:51:13 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 09:51:13 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 09:51:14 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 09:51:14 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749030674363","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"c28WvVn0WtGSrsifAAAT","timestamp":"2025-06-04T09:51:14.363Z","source":"socketio-server"}}
2025-06-04 09:51:14 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 09:51:14 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 09:51:14 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 10:08:22 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 10:08:23 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:08:23 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749031703071","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T10:08:23.071Z","timestamp":"2025-06-04T10:08:23.071Z","source":"socketio-server"}}
2025-06-04 10:08:23 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:08:23 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:08:23 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 10:08:50 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 10:08:51 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:08:51 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749031731740","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T10:08:51.740Z","timestamp":"2025-06-04T10:08:51.740Z","source":"socketio-server"}}
2025-06-04 10:08:51 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:08:51 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:08:51 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 10:16:17 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 10:16:17 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 10:16:17 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 10:16:17 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:16:17 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:16:17 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 10:16:17 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749032177795","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"8-VDebUWBggVj30gAAAW","timestamp":"2025-06-04T10:16:17.795Z","source":"socketio-server"}}
2025-06-04 10:16:17 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:16:55 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 10:16:55 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 10:16:55 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 10:16:55 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:16:56 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749032215994","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"3YejGKE5bKxkaKqsAAAZ","timestamp":"2025-06-04T10:16:55.994Z","source":"socketio-server"}}
2025-06-04 10:16:56 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:16:56 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:16:56 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 10:17:32 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 10:17:32 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:17:32 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749032252543","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T10:17:32.543Z","timestamp":"2025-06-04T10:17:32.543Z","source":"socketio-server"}}
2025-06-04 10:17:32 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:17:32 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:17:32 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 10:17:35 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 10:17:35 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:17:35 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749032255776","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T10:17:35.776Z","timestamp":"2025-06-04T10:17:35.776Z","source":"socketio-server"}}
2025-06-04 10:17:35 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:17:35 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:17:35 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 10:18:24 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 10:18:24 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 10:18:24 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 10:18:24 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:18:24 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749032304368","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"3RPKn-oJRipz5igvAAAc","timestamp":"2025-06-04T10:18:24.368Z","source":"socketio-server"}}
2025-06-04 10:18:24 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:18:24 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:18:24 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 10:18:37 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 10:18:37 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 10:18:37 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 10:18:37 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:18:37 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749032317833","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"KtjQzNjAtF_SiuYQAAAf","timestamp":"2025-06-04T10:18:37.833Z","source":"socketio-server"}}
2025-06-04 10:18:37 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:18:37 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:18:37 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 10:18:56 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 10:18:56 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:18:56 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:18:56 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 10:18:56 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749032336847","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T10:18:56.847Z","timestamp":"2025-06-04T10:18:56.847Z","source":"socketio-server"}}
2025-06-04 10:18:56 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:18:58 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 10:18:58 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 10:18:58 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 10:18:58 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:18:58 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749032338522","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"UCXPdm3QBFONiEmdAAAi","timestamp":"2025-06-04T10:18:58.522Z","source":"socketio-server"}}
2025-06-04 10:18:58 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:18:58 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:18:58 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 10:19:39 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 10:19:39 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:19:39 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749032379540","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T10:19:39.540Z","timestamp":"2025-06-04T10:19:39.540Z","source":"socketio-server"}}
2025-06-04 10:19:39 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:19:39 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:19:39 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 10:19:40 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 10:19:40 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 10:19:40 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 10:19:40 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:19:40 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749032380683","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"aCviSVPAKXq2lCDMAAAl","timestamp":"2025-06-04T10:19:40.683Z","source":"socketio-server"}}
2025-06-04 10:19:40 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:19:40 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:19:40 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 10:19:51 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 10:19:51 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 10:19:51 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:19:51 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749032391640","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T10:19:51.640Z","timestamp":"2025-06-04T10:19:51.640Z","source":"socketio-server"}}
2025-06-04 10:19:51 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:19:51 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:19:51 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:19:51 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 10:19:51 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749032391640","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T10:19:51.640Z","timestamp":"2025-06-04T10:19:51.640Z","source":"socketio-server"}}
2025-06-04 10:19:51 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:19:51 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:19:51 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 10:23:13 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 10:23:13 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 10:23:13 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 10:23:13 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:23:13 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749032593502","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"GQQ-vgqKdiVkD9XCAAAo","timestamp":"2025-06-04T10:23:13.502Z","source":"socketio-server"}}
2025-06-04 10:23:13 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:23:13 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:23:13 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 10:23:13 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 10:23:13 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 10:23:13 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 10:23:13 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 10:23:13 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749032593560","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"hor55azf0qn1UYLuAAAp","timestamp":"2025-06-04T10:23:13.560Z","source":"socketio-server"}}
2025-06-04 10:23:13 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 10:23:13 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 10:23:13 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 11:15:56 [ERROR]: ❌ PostgreSQL connection test failed: 
2025-06-04 11:16:04 [INFO]: ✅ PostgreSQL client connected 
2025-06-04 11:16:10 [INFO]: ✅ PostgreSQL connection test successful: {"now":"2025-06-04T11:16:04.035Z"}
2025-06-04 11:16:10 [INFO]: ✅ PostgreSQL connected successfully 
2025-06-04 11:16:10 [INFO]: ✅ Redis connected successfully 
2025-06-04 11:16:10 [INFO]: ✅ Socket.IO Redis adapter configured 
2025-06-04 11:16:10 [INFO]: ⏳ Waiting for Kafka group coordinator to be ready... 
2025-06-04 11:16:40 [INFO]: 🔄 PostgreSQL client removed 
2025-06-04 11:17:40 [INFO]: ✅ Kafka producer connected successfully 
2025-06-04 11:17:40 [INFO]: ✅ All Kafka topics already exist 
2025-06-04 11:17:40 [INFO]: ⏳ Waiting for Kafka consumer group coordinator for group: socketio-server... 
2025-06-04 11:17:55 [INFO]: ✅ Kafka consumer connected successfully with group: socketio-server 
2025-06-04 11:17:56 [INFO]: ✅ Kafka producer and consumer initialized 
2025-06-04 11:18:22 [WARN]: Kafka consumer failed, will restart: 
2025-06-04 11:18:22 [INFO]: 🚀 Socket.IO server running on 0.0.0.0:3001 
2025-06-04 11:18:22 [INFO]: 📡 CORS origins: http://localhost:3000,http://host.docker.internal:3000 
2025-06-04 11:18:22 [INFO]: 💾 Redis: redis:6379 
2025-06-04 11:18:22 [INFO]: 📨 Kafka: kafka:9092 
2025-06-04 11:18:22 [INFO]: 🔐 Auth: NextAuth 5 JWT validation enabled 
2025-06-04 11:18:22 [INFO]: 🔑 Internal API: Enabled for testing 
2025-06-04 11:18:22 [INFO]: ⚡ Max connections: 1000 
2025-06-04 11:18:22 [WARN]: Kafka consumer failed, will restart: 
2025-06-04 11:23:16 [INFO]: 🛑 Received SIGTERM. Starting graceful shutdown... 
2025-06-04 11:23:16 [INFO]: ✅ HTTP server closed 
2025-06-04 11:23:16 [INFO]: ✅ Redis connections closed 
2025-06-04 11:23:16 [INFO]: ✅ Socket.IO server closed 
2025-06-04 11:23:17 [INFO]: ✅ Kafka connections closed 
2025-06-04 11:24:17 [INFO]: ✅ PostgreSQL client connected 
2025-06-04 11:24:17 [INFO]: ✅ PostgreSQL connection test successful: {"now":"2025-06-04T11:24:17.676Z"}
2025-06-04 11:24:17 [INFO]: ✅ PostgreSQL connected successfully 
2025-06-04 11:24:17 [INFO]: ✅ Redis connected successfully 
2025-06-04 11:24:17 [INFO]: ✅ Socket.IO Redis adapter configured 
2025-06-04 11:24:17 [INFO]: ⏳ Waiting for Kafka group coordinator to be ready... 
2025-06-04 11:24:47 [INFO]: 🔄 PostgreSQL client removed 
2025-06-04 11:25:06 [INFO]: ✅ Kafka producer connected successfully 
2025-06-04 11:25:06 [INFO]: ✅ All Kafka topics already exist 
2025-06-04 11:25:06 [INFO]: ⏳ Waiting for Kafka consumer group coordinator for group: socketio-server... 
2025-06-04 11:25:21 [INFO]: ✅ Kafka consumer connected successfully with group: socketio-server 
2025-06-04 11:25:21 [INFO]: ✅ Kafka producer and consumer initialized 
2025-06-04 11:25:55 [INFO]: 🚀 Socket.IO server running on 0.0.0.0:3001 
2025-06-04 11:25:55 [INFO]: 📡 CORS origins: http://localhost:3000,http://host.docker.internal:3000 
2025-06-04 11:25:55 [INFO]: 💾 Redis: redis:6379 
2025-06-04 11:25:55 [INFO]: 📨 Kafka: kafka:9092 
2025-06-04 11:25:55 [INFO]: 🔐 Auth: NextAuth 5 JWT validation enabled 
2025-06-04 11:25:55 [INFO]: 🔑 Internal API: Enabled for testing 
2025-06-04 11:25:55 [INFO]: ⚡ Max connections: 1000 
2025-06-04 11:40:42 [ERROR]: ❌ JWT verification failed with both secrets: {"nextAuthError":"jwt malformed","jwtSecretError":"jwt malformed"}
2025-06-04 11:42:38 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-04 11:42:38 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:42:38 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-04 11:42:39 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:39 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037358933","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"KoRETOpuC08ysEl9AAAD","timestamp":"2025-06-04T11:42:38.934Z","source":"socketio-server"}}
2025-06-04 11:42:39 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:39 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:39 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-04 11:42:41 [ERROR]: unhandledRejection: logError is not defined
ReferenceError: logError is not defined
    at Socket.<anonymous> (/app/handlers/presence.js:296:7)
    at Socket.emit (node:events:518:28)
    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)
    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11) {"error":{},"stack":"ReferenceError: logError is not defined\n    at Socket.<anonymous> (/app/handlers/presence.js:296:7)\n    at Socket.emit (node:events:518:28)\n    at Socket.emitUntyped (/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js:69:22)\n    at /app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js:697:39\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","rejection":true,"date":"Wed Jun 04 2025 11:42:41 GMT+0000 (Coordinated Universal Time)","process":{"pid":7,"uid":1001,"gid":65533,"cwd":"/app","execPath":"/usr/local/bin/node","version":"v22.16.0","argv":["/usr/local/bin/node","/app/server.js"],"memoryUsage":{"rss":77201408,"heapTotal":26173440,"heapUsed":24959008,"external":2928426,"arrayBuffers":600292}},"os":{"loadavg":[2.78,3.08,2.37],"uptime":1127.47},"trace":[{"column":7,"file":"/app/handlers/presence.js","function":null,"line":296,"method":null,"native":false},{"column":28,"file":"node:events","function":"Socket.emit","line":518,"method":"emit","native":false},{"column":22,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/typed-events.js","function":"Socket.emitUntyped","line":69,"method":"emitUntyped","native":false},{"column":39,"file":"/app/node_modules/.pnpm/socket.io@4.8.1/node_modules/socket.io/dist/socket.js","function":null,"line":697,"method":null,"native":false},{"column":11,"file":"node:internal/process/task_queues","function":"process.processTicksAndRejections","line":85,"method":"processTicksAndRejections","native":false}]}
2025-06-04 11:42:43 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-04 11:42:43 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:42:43 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-04 11:42:43 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:43 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:43 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-04 11:42:43 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037363046","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"2Q7Nbzruf45XrJ4YAAAF","timestamp":"2025-06-04T11:42:43.047Z","source":"socketio-server"}}
2025-06-04 11:42:43 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:46 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:42:46 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:42:46 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:42:46 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:46 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037366248","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"jVszy7DWvbKEFSDFAAAM","timestamp":"2025-06-04T11:42:46.248Z","source":"socketio-server"}}
2025-06-04 11:42:46 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:46 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:42:46 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:46 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037366248","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"ObuGEaq0jPlrkLk6AAAL","timestamp":"2025-06-04T11:42:46.248Z","source":"socketio-server"}}
2025-06-04 11:42:46 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:46 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:42:46 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:46 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037366361","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"f5u_keFTg3Uns_-dAAAN","timestamp":"2025-06-04T11:42:46.361Z","source":"socketio-server"}}
2025-06-04 11:42:46 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:46 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037366426","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"pJGeUYiFBoQpF27QAAAO","timestamp":"2025-06-04T11:42:46.426Z","source":"socketio-server"}}
2025-06-04 11:42:46 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:46 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:46 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-04 11:42:46 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:46 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-04 11:42:46 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037366501","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"0K4OQiCMX-FYb-WgAAAP","timestamp":"2025-06-04T11:42:46.501Z","source":"socketio-server"}}
2025-06-04 11:42:46 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:46 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:46 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-04 11:42:46 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037366691","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-04T11:42:46.691Z","timestamp":"2025-06-04T11:42:46.691Z","source":"socketio-server"}}
2025-06-04 11:42:46 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:46 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:42:46 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:46 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037366691","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-04T11:42:46.691Z","timestamp":"2025-06-04T11:42:46.691Z","source":"socketio-server"}}
2025-06-04 11:42:46 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:46 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037366696","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-04T11:42:46.696Z","timestamp":"2025-06-04T11:42:46.696Z","source":"socketio-server"}}
2025-06-04 11:42:46 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:46 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037366749","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-04T11:42:46.749Z","timestamp":"2025-06-04T11:42:46.749Z","source":"socketio-server"}}
2025-06-04 11:42:46 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:46 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-04 11:42:46 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:46 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037366781","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-04T11:42:46.780Z","timestamp":"2025-06-04T11:42:46.781Z","source":"socketio-server"}}
2025-06-04 11:42:46 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:47 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:47 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-04 11:42:47 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:47 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037366815","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"woMXfLeSTN3F5Ub7AAAR","timestamp":"2025-06-04T11:42:46.815Z","source":"socketio-server"}}
2025-06-04 11:42:47 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:47 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:47 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-04 11:42:47 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:47 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-04 11:42:47 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:47 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-04 11:42:48 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-04 11:42:48 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037368902","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-04T11:42:48.902Z","timestamp":"2025-06-04T11:42:48.902Z","source":"socketio-server"}}
2025-06-04 11:42:48 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:48 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:48 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:48 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-04 11:42:49 [INFO]: ✅ User authenticated: Test User (test-user-12345) 
2025-06-04 11:42:49 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:42:49 [INFO]: 👤 User connected: Test User (test-user-12345) 
2025-06-04 11:42:49 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:49 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037369929","action":"user_online","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"socketId":"YRKZsBLURpLfXJg6AAAT","timestamp":"2025-06-04T11:42:49.929Z","source":"socketio-server"}}
2025-06-04 11:42:49 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:49 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:49 [INFO]: ✅ User connection established: Test User (test-user-12345) 
2025-06-04 11:42:49 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-04 11:42:49 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: client namespace disconnect 
2025-06-04 11:42:49 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:49 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037369980","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-04T11:42:49.980Z","timestamp":"2025-06-04T11:42:49.980Z","source":"socketio-server"}}
2025-06-04 11:42:49 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:50 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:42:50 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:50 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-04 11:42:50 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037369980","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"client namespace disconnect","lastSeen":"2025-06-04T11:42:49.980Z","timestamp":"2025-06-04T11:42:49.980Z","source":"socketio-server"}}
2025-06-04 11:42:50 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:42:50 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:42:50 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-04 11:44:14 [INFO]: 👋 User disconnecting: Test User (test-user-12345) - Reason: ping timeout 
2025-06-04 11:44:14 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"test-user-12345","partition":2}
2025-06-04 11:44:14 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-test-user-12345-1749037454886","action":"user_offline","userId":"test-user-12345","userInfo":{"id":"test-user-12345","name":"Test User","email":"test@edumatrix.com"},"disconnectReason":"ping timeout","lastSeen":"2025-06-04T11:44:14.886Z","timestamp":"2025-06-04T11:44:14.886Z","source":"socketio-server"}}
2025-06-04 11:44:14 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:44:14 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"test-user-12345","partition":0}
2025-06-04 11:44:14 [INFO]: ✅ User disconnection handled: Test User (test-user-12345) 
2025-06-04 11:49:55 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 11:49:55 [WARN]: ❌ Missing origin/referer header 
2025-06-04 11:53:51 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 11:53:51 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:53:51 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 11:53:51 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 11:53:51 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 11:53:51 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 11:53:51 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038031322","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"f4BY5ajUPrY1r_o2AAAY","timestamp":"2025-06-04T11:53:51.322Z","source":"socketio-server"}}
2025-06-04 11:53:51 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:54:41 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 11:54:41 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 11:54:41 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 11:54:41 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 11:54:41 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038081398","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T11:54:41.398Z","timestamp":"2025-06-04T11:54:41.399Z","source":"socketio-server"}}
2025-06-04 11:54:41 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:54:42 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 11:54:42 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:54:42 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 11:54:42 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 11:54:42 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038082649","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"7iyqB9GqmEBV4MA_AAAb","timestamp":"2025-06-04T11:54:42.649Z","source":"socketio-server"}}
2025-06-04 11:54:42 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:54:42 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 11:54:42 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 11:54:46 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 11:54:46 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 11:54:46 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 11:54:46 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 11:54:46 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038086658","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T11:54:46.658Z","timestamp":"2025-06-04T11:54:46.658Z","source":"socketio-server"}}
2025-06-04 11:54:46 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:54:47 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 11:54:47 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:54:47 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 11:54:47 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 11:54:47 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 11:54:47 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 11:54:47 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038087690","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"D9stYTtmgHbBxZKGAAAe","timestamp":"2025-06-04T11:54:47.690Z","source":"socketio-server"}}
2025-06-04 11:54:47 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:54:57 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 11:54:57 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 11:54:57 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 11:54:57 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 11:54:57 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038097348","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T11:54:57.348Z","timestamp":"2025-06-04T11:54:57.348Z","source":"socketio-server"}}
2025-06-04 11:54:57 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:54:58 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 11:54:58 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:54:58 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 11:54:58 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 11:54:58 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038098280","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"khmn0X3wf68Vg-h1AAAh","timestamp":"2025-06-04T11:54:58.280Z","source":"socketio-server"}}
2025-06-04 11:54:58 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:54:58 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 11:54:58 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 11:55:12 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 11:55:12 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 11:55:12 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038112186","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T11:55:12.186Z","timestamp":"2025-06-04T11:55:12.186Z","source":"socketio-server"}}
2025-06-04 11:55:12 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:55:12 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 11:55:12 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 11:55:13 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 11:55:13 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:55:13 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 11:55:13 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 11:55:13 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038113280","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"-72nv_qvcsvgbsDWAAAk","timestamp":"2025-06-04T11:55:13.280Z","source":"socketio-server"}}
2025-06-04 11:55:13 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:55:13 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 11:55:13 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 11:55:33 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 11:55:33 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 11:55:33 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038133492","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T11:55:33.492Z","timestamp":"2025-06-04T11:55:33.492Z","source":"socketio-server"}}
2025-06-04 11:55:33 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:55:33 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 11:55:33 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 11:55:34 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 11:55:34 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:55:34 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 11:55:34 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 11:55:34 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038134560","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"dqNS9wI4hrOc5c06AAAn","timestamp":"2025-06-04T11:55:34.560Z","source":"socketio-server"}}
2025-06-04 11:55:34 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:55:34 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 11:55:34 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 11:56:34 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 11:56:34 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 11:56:34 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038194695","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T11:56:34.695Z","timestamp":"2025-06-04T11:56:34.695Z","source":"socketio-server"}}
2025-06-04 11:56:34 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:56:34 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 11:56:34 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 11:56:37 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 11:56:37 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:56:37 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 11:56:37 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 11:56:37 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038197753","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"mdhKoVXbJH4TA1K_AAAq","timestamp":"2025-06-04T11:56:37.753Z","source":"socketio-server"}}
2025-06-04 11:56:37 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:56:37 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 11:56:37 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 11:57:08 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 11:57:08 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 11:57:08 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 11:57:08 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 11:57:08 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038228819","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T11:57:08.819Z","timestamp":"2025-06-04T11:57:08.819Z","source":"socketio-server"}}
2025-06-04 11:57:08 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:57:09 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 11:57:09 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 11:57:09 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 11:57:10 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 11:57:10 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038230006","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"vf72VgGEaPP5HngAAAAt","timestamp":"2025-06-04T11:57:10.006Z","source":"socketio-server"}}
2025-06-04 11:57:10 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 11:57:10 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 11:57:10 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 12:00:00 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 12:00:00 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 12:00:00 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038400322","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T12:00:00.322Z","timestamp":"2025-06-04T12:00:00.323Z","source":"socketio-server"}}
2025-06-04 12:00:00 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 12:00:00 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 12:00:00 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 12:00:05 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 12:00:05 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 12:00:05 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 12:00:05 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 12:00:05 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 12:00:05 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 12:00:05 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749038405777","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"i9PlBS18yg6K3MktAAAw","timestamp":"2025-06-04T12:00:05.777Z","source":"socketio-server"}}
2025-06-04 12:00:05 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 13:03:47 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 13:03:47 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 13:03:47 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 13:03:47 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 13:03:47 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749042227329","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T13:03:47.329Z","timestamp":"2025-06-04T13:03:47.329Z","source":"socketio-server"}}
2025-06-04 13:03:47 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 13:42:46 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 13:42:46 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 13:42:46 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 13:42:46 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 13:42:46 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749044566832","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"eAQ51pH2CLc808t7AAAy","timestamp":"2025-06-04T13:42:46.832Z","source":"socketio-server"}}
2025-06-04 13:42:46 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 13:42:46 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 13:42:46 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 13:45:45 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 13:45:45 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 13:45:45 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 13:45:45 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 13:45:45 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 13:45:45 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 13:45:45 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749044745198","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"XuZIkK2mgL3abOu4AAA1","timestamp":"2025-06-04T13:45:45.198Z","source":"socketio-server"}}
2025-06-04 13:45:45 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 13:49:01 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 13:49:01 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 13:49:01 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749044941601","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T13:49:01.601Z","timestamp":"2025-06-04T13:49:01.601Z","source":"socketio-server"}}
2025-06-04 13:49:01 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 13:49:01 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 13:49:01 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 13:49:03 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 13:49:03 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 13:49:03 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 13:49:03 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 13:49:03 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749044943275","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"sF5dSa5EDJx5fj9VAAA4","timestamp":"2025-06-04T13:49:03.275Z","source":"socketio-server"}}
2025-06-04 13:49:03 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 13:49:03 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 13:49:03 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 13:49:31 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 13:49:31 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749044971731","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T13:49:31.731Z","timestamp":"2025-06-04T13:49:31.731Z","source":"socketio-server"}}
2025-06-04 13:49:31 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 13:49:31 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 13:49:31 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 13:49:31 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 13:49:33 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 13:49:33 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 13:49:33 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 13:49:33 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 13:49:33 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749044973352","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"F5ZHnKdsuKWRrn40AAA7","timestamp":"2025-06-04T13:49:33.352Z","source":"socketio-server"}}
2025-06-04 13:49:33 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 13:49:33 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 13:49:33 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 13:50:35 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 13:50:35 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 13:50:35 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749045035183","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T13:50:35.183Z","timestamp":"2025-06-04T13:50:35.183Z","source":"socketio-server"}}
2025-06-04 13:50:35 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 13:50:35 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 13:50:35 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 13:50:37 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 13:50:37 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 13:50:37 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 13:50:37 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 13:50:37 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749045037270","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"hOKWLWbftdGp13A6AAA-","timestamp":"2025-06-04T13:50:37.270Z","source":"socketio-server"}}
2025-06-04 13:50:37 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 13:50:37 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 13:50:37 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 13:58:13 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 13:58:13 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 13:58:13 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749045493748","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T13:58:13.748Z","timestamp":"2025-06-04T13:58:13.748Z","source":"socketio-server"}}
2025-06-04 13:58:13 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 13:58:13 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 13:58:13 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 13:58:15 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 13:58:15 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 13:58:15 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 13:58:15 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 13:58:15 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749045495536","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"YWx5v_1kf6XH7at-AABB","timestamp":"2025-06-04T13:58:15.536Z","source":"socketio-server"}}
2025-06-04 13:58:15 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 13:58:15 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 13:58:15 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 14:01:33 [WARN]: Kafka consumer failed, will restart: 
2025-06-04 14:03:49 [WARN]: Kafka consumer failed, will restart: 
2025-06-04 14:04:44 [WARN]: Kafka consumer failed, will restart: 
2025-06-04 14:04:55 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 14:04:55 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 14:04:55 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 14:04:55 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 14:05:47 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749045895423","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T14:04:55.423Z","timestamp":"2025-06-04T14:04:55.423Z","source":"socketio-server"}}
2025-06-04 14:05:47 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 14:09:23 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 14:09:23 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 14:09:23 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 14:09:23 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 14:09:23 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749046163668","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T14:09:23.668Z","timestamp":"2025-06-04T14:09:23.668Z","source":"socketio-server"}}
2025-06-04 14:09:23 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 14:09:43 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 14:09:43 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 14:09:43 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 14:09:43 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 14:09:43 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 14:09:43 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 14:09:43 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749046183279","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"TsklGUmqMNuwbvJoAABE","timestamp":"2025-06-04T14:09:43.279Z","source":"socketio-server"}}
2025-06-04 14:09:43 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 14:38:18 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 14:38:18 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 14:38:18 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749047898972","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T14:38:18.972Z","timestamp":"2025-06-04T14:38:18.972Z","source":"socketio-server"}}
2025-06-04 14:38:18 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 14:38:18 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 14:38:19 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 14:38:36 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 14:38:36 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 14:38:36 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 14:38:36 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 14:38:36 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 14:38:36 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 14:38:36 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749047916787","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"3I5telFJhk_sXYdfAABJ","timestamp":"2025-06-04T14:38:36.787Z","source":"socketio-server"}}
2025-06-04 14:38:36 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 14:40:47 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 14:40:47 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 14:40:47 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749048047571","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T14:40:47.571Z","timestamp":"2025-06-04T14:40:47.571Z","source":"socketio-server"}}
2025-06-04 14:40:47 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 14:40:47 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 14:40:47 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 14:41:06 [INFO]: ✅ Internal API key authenticated: Internal Test User (internal-test-user) 
2025-06-04 14:41:06 [INFO]: ✅ Connection validated from origin: http://localhost:3000 
2025-06-04 14:41:06 [INFO]: 👤 User connected: Internal Test User (internal-test-user) 
2025-06-04 14:41:06 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 14:41:06 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 14:41:06 [INFO]: ✅ User connection established: Internal Test User (internal-test-user) 
2025-06-04 14:41:06 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749048066133","action":"user_online","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"socketId":"iLoBV-GHUqbiptzbAABN","timestamp":"2025-06-04T14:41:06.133Z","source":"socketio-server"}}
2025-06-04 14:41:06 [WARN]: Unknown Kafka topic: user-actions 
2025-06-04 14:56:11 [INFO]: 👋 User disconnecting: Internal Test User (internal-test-user) - Reason: transport close 
2025-06-04 14:56:11 [INFO]: 📨 Published event to Kafka topic: user-actions {"topic":"user-actions","key":"internal-test-user","partition":2}
2025-06-04 14:56:11 [INFO]: 📨 Published event to Kafka topic: presence-events {"topic":"presence-events","key":"internal-test-user","partition":0}
2025-06-04 14:56:11 [INFO]: ✅ User disconnection handled: Internal Test User (internal-test-user) 
2025-06-04 14:56:11 [INFO]: 📨 Received Kafka message from topic: user-actions {"data":{"id":"user-internal-test-user-1749048971692","action":"user_offline","userId":"internal-test-user","userInfo":{"id":"internal-test-user","name":"Internal Test User","email":"test@internal.local"},"disconnectReason":"transport close","lastSeen":"2025-06-04T14:56:11.692Z","timestamp":"2025-06-04T14:56:11.692Z","source":"socketio-server"}}
2025-06-04 14:56:11 [WARN]: Unknown Kafka topic: user-actions 
